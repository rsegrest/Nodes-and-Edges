/**
 * This is a p5.js sketch made with p5js-template-petr-plus.
 *
 * @license CC0-1.0
 */
!function(e){"use strict";class t{constructor(e,t){this.x=e,this.y=t,this.x=e,this.y=t}toString(){return`Position:(x:${this.x}, y:${this.y})`}}class s{constructor(e){s.p=e}static plotLinesBetweenNodes(e,s){const n=e.position.x+e.dimensions.width/2,i=e.position.y+e.dimensions.height/2,o=s.position.x+s.dimensions.width/2,r=s.position.y+s.dimensions.height/2,c=n+(o-n)/2,h=c,d=r,l=new t(c,i),a=new t(h,d);return[new t(n,i),l,a,new t(o,r)]}static renderLines(e,t="rgb(200,0,0)"){const n=s.p;n.push(),n.noFill(),n.strokeWeight(3),n.stroke(t);for(let t=1;t<e.length;t+=1){const s=e[t-1],i=e[t];n.line(s.x,s.y,i.x,i.y)}n.pop()}static render(e){const t=e.getSourceNode(),s=e.getTargetNode(),n=this.plotLinesBetweenNodes(t,s);this.renderLines(n)}}class n{constructor(e){n.p=e}static render(){const e=n.p;e.push(),e.noFill(),e.strokeWeight(1),e.stroke("rgb(255,255,255,0.5)");for(let t=1;t<e.width/100;t+=1)e.line(100*t,0,100*t,e.height);for(let t=1;t<e.height/100;t+=1)e.line(0,100*t,e.width,100*t);e.pop()}static getP(){return n.p}}class i{constructor(e){this.isSelected=!1,i.p=e}static renderPlug(e,t){const s=e.getPosition(),n=s.x,i=s.y;let o="rgba(200,200,200,0.7)",r="rgba(255,255,200,0.7)";e.checkMouseOver(t.mouseX,t.mouseY)&&(o="rgba(255,255,72,1)",r="rgba(0,0,0,0.8)"),t.push(),t.stroke(o),t.strokeWeight(2),t.fill(r),t.circle(n,i,8),t.pop()}static showNodes(e,t){e.getPlugs().forEach((e=>{this.renderPlug(e,t)}))}static render(e,t,s=!1){const n=10,o=e.getBoundary(),r=e.dimensions.width,c=e.dimensions.height,h=e.position.x,d=e.position.y,l=e.getLabel();let a="rgba(228,200,200,1)";e.getIsSelected()&&(a="rgba(255,255,200,1)"),t.push(),t.translate(h,d),t.noStroke(),t.fill("rgba(0,0,0,0.5)");let u="rgb(128,128,128)",g=1;s&&(u="rgb(255,200,0)",g=3),t.rect(0,5,r,c,0,n,n,n),t.fill(a),t.stroke(u),t.strokeWeight(g),t.rect(3,0,r,c,0,n,n,n),t.fill(0),t.noStroke(),t.textAlign(t.CENTER,t.CENTER),t.text(l,6,3,r-6,c-6),t.pop();e.checkMouseOver(t.mouseX,t.mouseY)&&this.showNodes(e,t),i.drawRolloverGuide(o,t)}static drawRolloverGuide(e,t){t.push(),t.noFill(),t.stroke("rgb(0,255,255)"),t.strokeWeight(1),t.translate(e.left,e.top),t.rect(0,0,e.right-e.left,e.bottom-e.top),t.pop()}}class o{constructor(e,t){this.width=e,this.height=t}toString(){return`Dimension:(width:${this.width},  height:${this.height})`}}class r{constructor(e){this.width=0,this.height=0,this.width=e.width,this.height=e.height}createInstance(e){return null===r.instance&&(r.instance=new r(e)),r.instance}getInstance(){if(null===r.instance)throw new Error("Layout instance is not created yet");return r.instance}static getDistance(e,t){const s=e.x-t.x,n=e.y-t.y;return Math.sqrt(s*s+n*n)}}r.instance=null,r.BASE_NODE_WIDTH=100,r.BASE_NODE_HEIGHT=50;class c{constructor(e,t){this.plugPosition=e,this.position=t,this.plugSocket=null,this.plugPosition=e,this.position=t}getPosition(){return this.position}checkMouseOver(e,s){return r.getDistance(this.position,new t(e,s))<15}plugIn(e){this.plugSocket=e}toString(){return`Plug: ${this.plugPosition}, position: ${this.position}, plugSocket: ${this.plugSocket}`}}const h="N",d="S",l="E",a="W",u="NE",g="NW",p="SE",w="SW";class m{constructor(e,t,s,n){this.id=e,this.label=t,this.position=s,this.dimensions=n,this.showNodes=!1,this.isSelected=!1,this.id=e,this.label=t,this.position=s,this.dimensions=n,this.plugs=this.createPlugs()}getBoundary(){return{left:this.position.x-10,top:this.position.y-10,right:this.position.x+10+this.dimensions.width,bottom:this.position.y+10+this.dimensions.height}}checkMouseOver(e,t){const s=this.getBoundary();return e>=s.left&&e<=s.right&&t>=s.top&&t<=s.bottom}createPlugs(){const e=[],t=[g,w,p,u,h,d,l,a];for(let s=0;s<8;s++){const n=new c(t[s],this.getPlugPosition(t[s]));e.push(n)}return e}setSelected(e=!0){this.isSelected=e}deselect(){this.isSelected=!1}getIsSelected(){return this.isSelected}getPlugPosition(e){const s=this.position.x,n=this.position.y,i=this.dimensions.width,o=this.dimensions.height;switch(e){case g:return new t(s+3,n);case h:return new t(s+3+i/2,n);case u:return new t(s+3+i,n);case w:return new t(s+3,n+o);case d:return new t(s+3+i/2,n+o);case p:return new t(s+3+i,n+o);case a:return new t(s+3,n+o/2);case l:return new t(s+3+i,n+o/2);default:return new t(0,0)}}getID(){return this.id}getLabel(){return this.label}getShowNodes(){return this.showNodes}getPlugs(){return this.plugs}getPlugByPosition(e){return this.plugs.find((t=>t.plugPosition===e))}toString(){return`NodeModel: ${this.id} ${this.label} ${this.position.toString()} ${this.dimensions.toString()}`}}class S{constructor(){}static createInstance(){return S.instance||(S.instance=new S),S.instance}static getInstance(){if(!S.instance)throw new Error("CreationManager instance is not created yet");return S.instance}createNodeModel(e,t,s,n){return new m(e,t,s,n)}createPlug(e,t){return new c(e,t)}static populateNodeAndEdgeList(){const e=S.createNodes();return{nodes:e,edges:S.createEdges(e)}}static createNodes(){const e=[],s=["Solar Array","Cable","Avionics","Radiator"];for(let n=0;n<4;n+=1){const i=(n+1).toString(),r=s[n],c=new t(10+150*n+10*n,20),h=new o(100,50),d=new m(i,r,c,h);e.push(d)}return e}static createEdges(e){return[]}}class E{constructor(e){this.nodes=[],this.edges=[],E.setP(e),this.nodes=S.createNodes()}renderElements(){const e=s.plotLinesBetweenNodes(this.nodes[0],this.nodes[1]),t=s.plotLinesBetweenNodes(this.nodes[1],this.nodes[2]),o=s.plotLinesBetweenNodes(this.nodes[2],this.nodes[3]);s.renderLines(e),s.renderLines(t),s.renderLines(o,"rgb(0,0,200)"),this.nodes.forEach((e=>{i.render(e,E.getP())})),n.render()}testAddHtmlDiv(){const e=document.createElement("p");e.innerHTML="This is an HTML div appended to a top-layer div";const t=document.getElementById("htmlContainer");null==t||t.appendChild(e)}static createContainer(e,t){const s=document.createElement("div");return t.appendChild(s),{container:s}}getSelectedNodes(){return this.nodes.filter((e=>e.getIsSelected()))}checkForSelectNode(){const e=new t(E.p.mouseX,E.p.mouseY);for(let t=0;t<this.nodes.length;t+=1)if(null!==this.nodes[t]&&void 0!==this.nodes[t]){const s=this.nodes[t];s.setSelected(!1),s.checkMouseOver(e.x,e.y)&&s.setSelected()}}mouseClicked(){console.log(`ChartManager.mouseClicked() @ ${new t(E.p.mouseX,E.p.mouseY)}`),this.nodes.forEach(((e,t)=>{this.checkForSelectNode()}))}addNode(e){this.nodes.push(e)}removeNode(e){const t=this.nodes.indexOf(e);t>-1&&this.nodes.splice(t,1)}addEdge(e){this.edges.push(e)}removeEdge(e){const t=this.edges.indexOf(e);t>-1&&this.edges.splice(t,1)}getNodes(){return this.nodes}getEdges(){return this.edges}selectNode(e){e.setSelected()}deselectNode(e){e.deselect()}static createInstance(e){return null===E.instance&&(E.instance=new E(e)),E.instance}static getInstance(){if(null===E.instance)throw new Error("ChartManager instance is not created yet");return E.instance}static setP(e){E.p=e}static getP(){return E.p}toString(){let e=`ChartManager:\n\t${this.nodes.length} nodes,\n\t${this.edges.length}\n`;return e+="NODES: [\n\t",this.nodes.forEach((t=>{e+=`\t${t.toString()},\n`})),e+="]\nEDGES: [\n\t",this.edges.forEach((t=>{e+=`\t${t.toString()},\n`})),e+="",e}}let f,N;E.instance=null;let k;const b=(e=>{const t=Object.keys(e);return s=>{t.forEach((t=>{const n=e[t];n&&(s[t]=n.bind(void 0,s))}))}})({preload:e=>{e.loadFont("./font/Regular.otf")},setup:e=>{N=e,N.createCanvas(800,600),N.frameRate(1),N.background(248),new i(N),new s(N),new n(N),f=E.createInstance(N),S.createInstance(),console.log("p"),console.log(N)},draw:e=>{k=e,k.background("rgb(180,180,200)"),f.renderElements()},mouseClicked:function(){f.mouseClicked()}});new e(b)}(p5);