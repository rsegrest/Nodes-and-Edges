/**
 * This is a p5.js sketch made with p5js-template-petr-plus.
 *
 * @license CC0-1.0
 */
!function(t){"use strict";class e{constructor(t,e){this.x=t,this.y=e,this.x=t,this.y=e}toString(){return`Position:(x:${this.x}, y:${this.y})`}static getDistance(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}getDistance(t){return e.getDistance(this,t)}}class s{constructor(t,e,s,i){this.left=t,this.top=e,this.right=s,this.bottom=i}getLeft(){return this.left}getTop(){return this.top}getRight(){return this.right}getBottom(){return this.bottom}getBoundary(){return{left:this.left,top:this.top,right:this.right,bottom:this.bottom}}toString(){return`Boundary=[left: ${this.left}, top: ${this.top}, right: ${this.right}, bottom: ${this.bottom}]`}}class i{constructor(t,e,s,i,n=null,o=null,r=null){this._isClickable=!0,this._isSelectable=!1,this._isDraggable=!1,this._isResizable=!1,this.position=null,this.dimensions=null,this.boundary=null,this.isVisible=!0,this.isSelected=!1,this.isRolledOver=!1,this._isClickable=t,this._isDraggable=e,this._isResizable=s,this._isSelectable=i,n&&this.setPosition(n),o&&this.setDimensions(o),r&&this.setUpBoundary()}checkMouseOver(t,e){const s=this.getBoundary();if(!s)return!1;return t>=s.getLeft()&&t<=s.getRight()&&e>=s.getTop()&&e<=s.getBottom()}getIsDraggable(){return this._isDraggable}getIsClickable(){return this._isClickable}getIsResizable(){return this._isResizable}setPosition(t){this.position=t,this.setUpBoundary()}getPosition(){return this.position}setDimensions(t){this.dimensions=t,this.setUpBoundary()}getDimensions(){return this.dimensions}setUpBoundary(t=0){const e=this.getPosition(),i=this.getDimensions();if(null==e||null==i)return;const n=new s(this.position.x-t,this.position.y-t,this.position.x+this.dimensions.width+t,this.position.y+this.dimensions.height+t);this.boundary=n}getBoundary(){return this.boundary}setVisible(t=!0){this.isVisible=t}setHidden(t=!0){this.isVisible=!t}getIsVisible(){return this.isVisible}getIsHidden(){return!this.isVisible}getIsRolledOver(){return this.isRolledOver}setIsRolledOver(t=!0){this.isRolledOver=t}getIsSelected(){return this.isSelected}setIsSelected(t=!0){this.isSelected=t}getIsSelectable(){return this._isSelectable}setSelectable(t=!0){this._isSelectable=t}}class n{constructor(t,e){this.width=t,this.height=e}toString(){return`Dimension:(width:${this.width},  height:${this.height})`}}class o extends i{constructor(){super(!0,!1,!1,!1,new e(10,400),new n(300,190)),this.type="Inspector",this.isCollapsed=!1}clickAction(){console.log("inspector pane clicked")}}class r extends i{constructor(t=null,e=null,s=!1,i=null){super(!0,!0,!0,s,t,e,i),this.isResizable=s,this.isDragging=!1}setCursor(t){let e="pointer";t&&(e="grab");document.getElementById("defaultCanvas0").style.cursor=e}setIsDragging(t){this.isDragging=t}getIsDragging(){return this.isDragging}}class l extends r{constructor(t,e,s,i=null,n=null,o="Tool"){super(i,n,!1),this.name=t,this.type=o,this.name=t,this.icon=e,this.objectType=s,this.setUpBoundary()}getName(){return this.name}getIcon(){return this.icon}getObjectType(){return this.objectType}clickAction(){console.log("tool clicked")}dragToPosition(t){this.setPosition(t)}toString(){return`Tool: ${this.name}, ${this.icon}, ${this.objectType},\n\tPos: ${this.position},\n\tDim:${this.dimensions}`}}class a extends i{constructor(){super(!0,!1,!1,!1,new e(600,10),new n(190,580)),this.type="Toolbox",this.toolList=[],this.isCollapsed=!1,this.initialize()}initialize(){this.toolList.push(new l("Element","E","Element")),this.toolList.push(new l("Subelement","S","Subelement")),this.toolList.push(new l("Edge","E","Edge")),this.setToolLayout()}static findHorizontalCenterLine(t){const e=t.getPosition();return e?e.x+95:0}static findFirstRowOffsetY(t){const e=t.getPosition();if(!e)return 0;return 30+e.y}static findRowCenterLineY(t,e){return this.findFirstRowOffsetY(t)+e*this.ROW_SPACING}static calcNumToolGridColumns(){return 2}static calcNumToolGridRows(){return 6}setToolLayout(){const t=this.getToolList(),s=t.length;for(let i=0;i<s;i++){const s=t[i];s.setDimensions(new n(80,40)),s.setPosition(new e(10+this.position.x+i%2*90,this.position.y+40+50*Math.floor(i/2)))}}getToolList(){return this.toolList}clickAction(){console.log("toolbox clicked")}setIsCollapsed(t=!0){this.isCollapsed=t}getIsCollapsed(){return this.isCollapsed}checkMouseOver(t,e){const s=this.getBoundary();if(!s)return!1;return t>=s.getLeft()&&t<=s.getRight()&&e>=s.getTop()&&e<=s.getBottom()}toString(){return"ToolboxModel"}}a.ROW_SPACING=60;class h{constructor(t){this.width=0,this.height=0,this.width=t.width,this.height=t.height}static positionInspector(t,s){if(null===t)return;const i=t.getDimensions();if(null===i)return;const n=i.height,o=new e(10,s-(n+10));t.setPosition(o)}static positionToolboxAndTools(t,s){if(null===t)return;const i=t.getDimensions();if(null===i)return;const n=i.width,o=new e(s-(n+10),10);t.setPosition(o);const r=t.getToolList();if(null===r)return;const l=r.length;for(let t=0;t<l;t++){const s=r[t];if(null===s.getDimensions())return;const i=10,n=40;s.setPosition(new e(i+o.x+t%2*90,o.y+n+50*Math.floor(t/2)))}}static positionElementBasedOnScreenSize(t,e,s){t instanceof a&&h.positionToolboxAndTools(t,e),t instanceof o&&h.positionInspector(t,s)}createInstance(t){return null===h.instance&&(h.instance=new h(t)),h.instance}getInstance(){if(null===h.instance)throw new Error("Layout instance is not created yet");return h.instance}static getDistance(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}}h.instance=null,h.BASE_NODE_WIDTH=100,h.BASE_NODE_HEIGHT=50;class c extends r{constructor(t,e,s=!1){super(e,null,!1),this.plugPosition=t,this.isHighlit=s,this.type="Plug",this.plugSocket=null,this.plugPosition=t,this.position=e}dragToPosition(t){throw new Error("Method not implemented.")}clickAction(){throw new Error("Method not implemented.")}checkMouseOver(t,s){if(null!==this.position){return h.getDistance(this.position,new e(t,s))<15}return!1}plugIn(t){this.plugSocket=t}toString(){return`Plug: ${this.plugPosition}, position: ${this.position}, plugSocket: ${this.plugSocket}`}setIsHighlit(t=!0){this.isHighlit=t}getIsHighlit(){return this.isHighlit}}const u="N",g="S",d="E",p="W",m="NE",w="NW",f="SE",y="SW";class P extends r{constructor(t,e,s,i,n=[],o=[]){super(s,i),this.id=t,this.label=e,this.position=s,this.dimensions=i,this.inputParameterList=n,this.outputParameterList=o,this.type="Node",this.showNodes=!1,this.id=t,this.label=e,this.position=s,this.dimensions=i,this.plugs=this.createPlugs(),this.setUpBoundary()}getBoundary(){return super.getBoundary()}createPlugs(){const t=[],e=[w,y,f,m,u,g,d,p];for(let s=0;s<8;s++){const i=new c(e[s],this.getPlugPosition(e[s]));t.push(i)}return t}setSelected(t=!0){this.isSelected=t}deselect(){this.isSelected=!1}getIsSelected(){return this.isSelected}getPlugPosition(t){const s=this.position.x,i=this.position.y,n=this.dimensions.width,o=this.dimensions.height;switch(t){case w:return new e(s+3,i);case u:return new e(s+3+n/2,i);case m:return new e(s+3+n,i);case y:return new e(s+3,i+o);case g:return new e(s+3+n/2,i+o);case f:return new e(s+3+n,i+o);case p:return new e(s+3,i+o/2);case d:return new e(s+3+n,i+o/2);default:return new e(0,0)}}highlightClosestPlug(t,e){this.plugs.forEach((t=>{t.setIsHighlit(!1)}));const s=this.getPlugClosestToMouse(t,e);s&&s.setIsHighlit()}getPlugClosestToMouse(t,s){let i=null,n=1e5;for(let o=0;o<this.plugs.length;o++){const r=this.plugs[o],l=r.position.getDistance(new e(t,s));l<n&&(n=l,i=r)}return i}getID(){return this.id}getLabel(){return this.label}getShowNodes(){return this.showNodes}getPlugs(){return this.plugs}getPlugByPosition(t){return this.plugs.find((e=>e.plugPosition===t))}setIsRolledOver(t=!0){this.isRolledOver=t}getIsRolledOver(){return this.isRolledOver}clickAction(){throw"NodeModel clickAction not implemented"}setUpBoundary(){super.setUpBoundary(10)}setIsDragging(t){this.setCursor(t),this.isDragging=t,this.plugs.forEach((t=>{t.setIsDragging(!0)}))}dragToPosition(t){const s=this.position;this.position=t;const i=t.x-s.x,n=t.y-s.y;this.setUpBoundary(),this.plugs.forEach((t=>{null!==t&&t.setPosition(new e(t.position.x+i,t.position.y+n))}))}getInputParameterList(){return this.inputParameterList}getOutputParameterList(){return this.outputParameterList}addInputParameter(t){this.inputParameterList.push(t)}addOutputParameter(t){this.outputParameterList.push(t)}setInputParameterList(t){this.inputParameterList=t}setOutputParameterList(t){this.outputParameterList=t}toString(){return`NodeModel: ${this.id} ${this.label} ${this.position.toString()} ${this.dimensions.toString()}`}toDyreqtJson(){throw new Error("NodeModel-- toDyreqtJson: not yet implemented")}}class b{constructor(t,e,s=null){this.name=t,this.value=e,this.units=s}getName(){return this.name}getValue(){return this.value}getUnits(){return this.units}setValue(t){this.value=t}setUnits(t){this.name=`${this.name} (${t})`}toString(){let t=`Parameter: ${this.name}, value: ${this.value}`;return null!==this.units&&(t+=`, units: ${this.units}`),t}toJson(){return JSON.stringify(this)}}class T extends b{constructor(t,e,s=null){super(t,e,s),this.type="InputParameter"}}class S extends b{constructor(t,e,s=null){super(t,e,s),this.type="OutputParameter"}}class I{static createNewObjectFromDynamicTool(t){const e=null==t?void 0:t.getPosition(),s=null==t?void 0:t.getDimensions();return null==t||t.getObjectType(),new P("69","new node",e,s)}constructor(){}static createInstance(){return I.instance||(I.instance=new I),I.instance}static getInstance(){if(!I.instance)throw new Error("CreationManager instance is not created yet");return I.instance}static createNodeModel(t,e,s,i){return new P(t,e,s,i)}createPlug(t,e){return new c(t,e)}static populateNodeAndEdgeList(){return{nodes:I.createNodes(),edges:[]}}static createNodes(){const t=[],s=["Solar Array","Cable","Avionics","Radiator"],i=[new T("parameter1",1e3,"meters"),new T("parameter2",69,null),new T("fuel",420,"grams"),new T("Another fourth param","aStringValue","count")],o=[new S("parameter1",0,"meters"),new S("parameter2",6.9,null),new S("fuelRemaining",2,"grams"),new S("Another fourth param","aStringValue","count")];for(let r=0;r<4;r+=1){const l=(r+1).toString(),a=s[r],h=new e(10+150*r+10*r,20),c=new n(100,50),u=new P(l,a,h,c,i,o);t.push(u)}return t}static createEdges(){return[]}}class O extends l{constructor(t,e,s,i=null,n=null){super(t,e,s,i,n,"DynamicTool")}}class R{constructor(t){R.p=t}static plotLinesBetweenNodes(t,s){const i=t.position.x+t.dimensions.width/2,n=t.position.y+t.dimensions.height/2,o=s.position.x+s.dimensions.width/2,r=s.position.y+s.dimensions.height/2,l=i+(o-i)/2,a=l,h=r,c=new e(l,n),u=new e(a,h);return[new e(i,n),c,u,new e(o,r)]}static renderLines(t,e="rgb(200,0,0)"){const s=R.p;s.push(),s.noFill(),s.strokeWeight(3),s.stroke(e);for(let e=1;e<t.length;e+=1){const i=t[e-1],n=t[e];s.line(i.x,i.y,n.x,n.y)}s.pop()}static render(t){const e=t.getSourceNode(),s=t.getTargetNode(),i=this.plotLinesBetweenNodes(e,s);this.renderLines(i)}}class E{constructor(t){this.isSelected=!1,E.p=t}static renderPlug(t,e,s){if(null===t)return;const i=t.getPosition();if(null===i)return;const n=t.getIsSelected(),o=i.x,r=i.y;let l="rgba(200,200,200,0.7)",a="rgba(255,255,200,0.7)";t.checkMouseOver(e.mouseX,e.mouseY)&&(l="rgba(255,255,72,1)",a="rgba(0,0,0,0.8)"),n&&(l="rgba(255,0,72,1)",a="rgba(255,0,72,1)"),t.getIsHighlit()&&(l="rgba(0,0,255,1)",a="rgba(0,255,255,1)"),e.push(),e.stroke(l),e.strokeWeight(2),e.fill(a),(n||s)&&e.circle(o,r,8),e.pop()}static showNodes(t,e,s){t.getPlugs().forEach((t=>{this.renderPlug(t,e,s)}))}static render(t,e,s=!1){const i=10;t.getBoundary();const n=t.dimensions.width,o=t.dimensions.height,r=t.position.x,l=t.position.y,a=t.getLabel();let h="rgba(228,200,200,1)";t.getIsSelected()&&(h="rgba(255,255,200,1)"),e.push(),e.translate(r,l),e.noStroke(),e.fill("rgba(0,0,0,0.5)");let c="rgb(128,128,128)",u=1;s&&(c="rgb(255,200,0)",u=3),e.rect(0,5,n,o,0,i,i,i),e.fill(h),e.stroke(c),e.strokeWeight(u),e.rect(3,0,n,o,0,i,i,i),e.fill(0),e.noStroke(),e.textAlign(e.CENTER,e.CENTER),e.text(a,6,3,n-6,o-6),e.pop();const g=t.getIsRolledOver();this.showNodes(t,e,g),E.drawRolloverGuide(t.getBoundary(),e)}static drawRolloverGuide(t,e){e.push(),e.noFill(),e.stroke("rgb(0,255,255)"),e.strokeWeight(1),null!==t?(e.translate(t.getLeft(),t.getTop()),e.rect(0,0,t.getRight()-t.getLeft(),t.getBottom()-t.getTop()),e.pop()):console.warn("boundary is null in RenderNode.drawRolloverGuide")}}class v{constructor(t){v.p=t}static getP(){return v.p}static drawRolloverGuide(t,e){e.push(),e.noFill(),e.stroke("rgb(0,255,255)"),e.strokeWeight(1),null!==t?(e.translate(t.getLeft(),t.getTop()),e.rect(0,0,t.getRight()-t.getLeft(),t.getBottom()-t.getTop()),e.pop()):console.warn("boundary is null in RenderNode.drawRolloverGuide")}static render(t){const e=v.getP(),s=t.getBoundary();e.push();const i=t.getPosition(),n=t.getPosition();if(null===i||null===n||void 0===i||void 0===n)throw new Error("tool position data is null");"DynamicTool"===t.type?e.fill("rgba(255,255,0,1)"):"Tool"===t.type?e.fill("rgba(255,2,100,1)"):e.fill("rgba(128,0,255,1)"),e.stroke(72),e.strokeWeight(2),e.translate(s.getLeft(),s.getTop()),e.rect(0,0,s.getRight()-s.getLeft(),s.getBottom()-s.getTop()),e.noStroke(),e.fill(0),e.text(t.getName(),5,5,s.getRight()-s.getLeft(),s.getBottom()-s.getTop()),e.pop(),null!==s?this.drawRolloverGuide(s,e):console.warn("boundary is null in RenderTool.render")}}class x{constructor(t){x.p=t}static render(){const t=x.p;t.push(),t.noFill(),t.strokeWeight(1),t.stroke("rgb(255,255,255,0.5)");for(let e=1;e<t.width/100;e+=1)t.line(100*e,0,100*e,t.height);for(let e=1;e<t.height/100;e+=1)t.line(0,100*e,t.width,100*e);t.pop()}static getP(){return x.p}}class k{constructor(t){k.p=t}static getP(){return k.p}static renderTitle(t){const e=k.getP(),s=t.getPosition();s&&(e.push(),e.fill(255),e.noStroke(),e.text("TOOLBOX",s.x+10,s.y+20),e.push())}static renderTitleBar(t){const e=k.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(32,32,64,0.8)"),e.noStroke(),e.rect(s.x,s.y,i.width,30),e.fill(255),e.text("TOOLBOX",s.x+10,s.y+20),e.pop(),k.renderTitle(t))}static renderTools(t){t.getToolList().forEach(((t,e)=>{v.render(t)}))}static render(t){const e=k.getP();t.getPosition(),t.getDimensions(),k.renderBackground(t),k.renderTBBorder(t),k.renderTitleBar(t),k.renderTools(t),e.pop()}static renderBackground(t){const e=k.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(255,255,255,0.2)"),e.noStroke(),e.rect(s.x,s.y+30,i.width,i.height-30),e.pop())}static renderTBBorder(t){const e=k.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.noFill(),e.stroke("rgba(32,32,64,0.8)"),e.strokeWeight(3),e.rect(s.x,s.y,i.width,i.height))}}class D{constructor(t){D.p=t}static drawColumnDivider(t){const e=this.p,s=t.getPosition();if(null===e)throw new Error("p is null in RenderParameter");e.push(),e.noStroke(),e.translate(s.x+5,s.y+this.Y_FIRST_ROW_OFFSET),e.stroke(72),e.strokeWeight(1);const i=this.NAME_COLUMN_WIDTH-10,n=i,o=t.boundary.getBottom();e.line(i,-15,n,o),e.noStroke(),e.pop()}static renderText(t,e){const s=this.p,i=e.getPosition();if(null===s)throw new Error("p is null in RenderParameter");s.push(),s.translate(i.x+5,i.y+this.Y_FIRST_ROW_OFFSET+this.rowCount*this.Y_EACH_ROW_OFFSET),s.fill(0),s.text(t.getName(),0,0);let n=t.getValue();t.getUnits()&&(n+=` ${t.getUnits()}`),s.text(n,this.NAME_COLUMN_WIDTH,0),s.pop()}static renderParameterRowInInspector(t,e,s=!1,i=!1){s&&(D.rowCount=0,this.addHorizontalDivider(e,"Input Parameters"));if(null===D.p)throw new Error("p is null in RenderParameter");this.renderText(t,e),D.rowCount+=1}static addHorizontalDivider(t,e=null){const s=this.p,i=t.getPosition();if(null===s)throw new Error("p is null in RenderParameter");if(null===i)throw new Error("inspector position is null in RenderParameter");s.push(),s.fill("rgba(255,255,148,1)"),s.translate(t.boundary.getLeft()+2,t.boundary.getTop()+this.rowCount*this.Y_EACH_ROW_OFFSET+30),s.rect(0,0,t.boundary.getRight()-15,this.Y_EACH_ROW_OFFSET),s.fill(0),null!==e&&(s.text(e,5,15),s.stroke(0),s.strokeWeight(.5),s.line(5,18,.9*t.dimensions.width,18)),s.pop(),D.rowCount+=1}static render(t,e,s=!1){const i=this.p;if(null===i)throw new Error("p is null in RenderParameter");i.push(),i.translate(e.boundary.getLeft(),e.boundary.getTop()),i.fill("rgba(255,0,0,1)"),i.circle(0,0,10),i.pop(),this.renderParameterRowInInspector(t,e,s)}}D.p=null,D.rowCount=0,D.Y_FIRST_ROW_OFFSET=45,D.Y_EACH_ROW_OFFSET=20,D.NAME_COLUMN_WIDTH=150;class N{constructor(t){N.p=t}static render(t,e){let s=[],i=[];e&&(s=e.getInputParameterList(),i=e.getOutputParameterList()),N.renderBackground(t),N.renderInspectorBorder(t),N.renderTitleBar(t);const n=s.length;for(let e=0;e<n;e+=1)D.render(s[e],t,0===e);const o=i.length;for(let e=0;e<o;e+=1)D.render(i[e],t,!1)}static renderTitle(t){const e=N.getP(),s=t.getPosition();s&&(e.push(),e.fill(255),e.noStroke(),e.text("Object Inspector",s.x+10,s.y+20),e.push())}static renderTitleBar(t){const e=N.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(32,32,64,0.8)"),e.noStroke(),e.rect(s.x,s.y,i.width,30),e.pop(),N.renderTitle(t))}static renderBackground(t){const e=N.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(255,255,255,0.9)"),e.noStroke(),e.rect(s.x,s.y+30,i.width,i.height-30),e.pop())}static renderInspectorBorder(t){const e=N.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.noFill(),e.stroke("rgba(32,32,64,0.8)"),e.strokeWeight(3),e.rect(s.x,s.y,i.width,i.height),e.pop())}static getP(){return N.p}}class L{constructor(t){this.nodes=[],this.edges=[],this.toolbox=new a,this.inspector=new o,this.dynamicTool=null,this.rolledOverObjects=[],L.setP(t),this.nodes=I.createNodes()}repositionElementOnResize(t,e,s){h.positionElementBasedOnScreenSize(t,e,s)}resizeCanvas(t,e){this.repositionElementOnResize(this.toolbox,t,e),this.repositionElementOnResize(this.inspector,t,e)}mouseDragged(t){const e=this.getDragTarget();null!==e&&("Node"===e.type||"Edge"===e.type||"Plug"===e.type||"Tool"===e.type)&&e.setIsDragging(!0)}mousePressed(t){}clearDragTargets(){this.nodes.forEach((t=>{t.setIsDragging(!1),t.getPlugs().forEach((t=>t.setIsDragging(!1)))})),this.edges.forEach((t=>t.setIsDragging(!1))),this.toolbox.getToolList().forEach((t=>t.setIsDragging(!1)))}mouseReleased(t){if(null!==this.dynamicTool){const t=I.createNewObjectFromDynamicTool(this.dynamicTool);this.nodes.push(t),this.dynamicTool=null}this.dynamicTool=null,this.clearDragTargets()}getDragTarget(){const t=this.nodes,e=this.edges,s=this.nodes.flatMap((t=>t.getPlugs()));if(this.toolbox&&this.toolbox.getIsRolledOver()){const t=this.toolbox.getToolList();for(let e=0;e<t.length;e+=1){const s=t[e];if(s.getIsRolledOver())return s}}if(s.length>0)for(let t=0;t<s.length;t+=1){const e=s[t];if(void 0!==e&&(null!==e&&e.getIsRolledOver()))return e}if(e.length>0)for(let t=0;t<e.length;t+=1){const s=e[t];if(void 0!==s&&(null!==s&&(null==s?void 0:s.getIsRolledOver())))return s}if(t.length>0)for(let e=0;e<t.length;e+=1){const s=t[e];if(void 0!==s&&(null!==s&&(null==s?void 0:s.getIsRolledOver())))return s}return null}drawTestLines(){const t=R.plotLinesBetweenNodes(this.nodes[0],this.nodes[1]),e=R.plotLinesBetweenNodes(this.nodes[1],this.nodes[2]),s=R.plotLinesBetweenNodes(this.nodes[2],this.nodes[3]);R.renderLines(t),R.renderLines(e),R.renderLines(s,"rgb(0,0,200)")}renderElements(){const t=L.getP();this.nodes.forEach(((s,i)=>{if(s.checkMouseOver(t.mouseX,t.mouseY)?s.setIsRolledOver():s.setIsRolledOver(!1),s.getIsDragging()&&s.dragToPosition(new e(t.mouseX-40,t.mouseY-20)),this.getSelectedNodes().length>0){const s=this.getClosestPlugsOnSelectedNode()[0],i=[null==s?void 0:s.getPosition(),new e(t.mouseX,t.mouseY)];R.renderLines(i,"rgb(0,128,255)")}E.render(s,L.getP())})),k.render(this.toolbox),N.render(this.inspector,this.getSelectedNodes()[0]);this.toolbox.checkMouseOver(t.mouseX,t.mouseY)&&this.toolbox.setIsRolledOver(),this.toolbox.getToolList().forEach(((s,i)=>{s.getIsDragging()&&this.dragDynamicTool(new e(t.mouseX-40,t.mouseY-20),s);s.checkMouseOver(t.mouseX,t.mouseY)?s.setIsRolledOver():s.setIsRolledOver(!1)})),null!==this.dynamicTool&&v.render(this.dynamicTool),x.render()}dragDynamicTool(t,e=null){null===this.dynamicTool&&(this.dynamicTool=new O(null==e?void 0:e.getName(),null==e?void 0:e.getIcon(),null==e?void 0:e.getObjectType(),null==e?void 0:e.position,null==e?void 0:e.dimensions)),this.dynamicTool.dragToPosition(t)}setDynamicSlot(t){this.dynamicTool=t}static createContainer(t,e){const s=document.createElement("div");return e.appendChild(s),{container:s}}getSelectedNodes(){return this.nodes.filter((t=>t.getIsSelected()))}getRolledOverNodes(){return this.nodes.filter((t=>t.getIsRolledOver()))}checkForSelectNode(){const t=new e(L.p.mouseX,L.p.mouseY);for(let e=0;e<this.nodes.length;e+=1)if(null!==this.nodes[e]&&void 0!==this.nodes[e]){const s=this.nodes[e];s.setSelected(!1),s.checkMouseOver(t.x,t.y)&&s.setSelected()}}getClosestPlugsOnSelectedNode(){const t=this.getSelectedNodes(),e=[];if(t.length>0)for(let s=0;s<t.length;s+=1){const i=t[s].getPlugClosestToMouse(L.p.mouseX,L.p.mouseY);e.push(i)}return e}mouseClicked(){this.nodes.forEach(((t,e)=>{t.getPlugs().forEach((t=>{t.checkMouseOver(L.p.mouseX,L.p.mouseY)&&t.setIsSelected()})),this.checkForSelectNode()}))}addNode(t){this.nodes.push(t)}removeNode(t){const e=this.nodes.indexOf(t);e>-1&&this.nodes.splice(e,1)}addEdge(t){this.edges.push(t)}removeEdge(t){const e=this.edges.indexOf(t);e>-1&&this.edges.splice(e,1)}getNodes(){return this.nodes}getEdges(){return this.edges}selectNode(t){t.setSelected()}deselectNode(t){t.deselect()}static createInstance(t){return null===L.instance&&(L.instance=new L(t)),L.instance}static getInstance(){if(null===L.instance)throw new Error("ChartManager instance is not created yet");return L.instance}static setP(t){L.p=t}static getP(){return L.p}toString(){let t=`ChartManager:\n\t${this.nodes.length} nodes,\n\t${this.edges.length}\n`;return t+="NODES: [\n\t",this.nodes.forEach((e=>{t+=`\t${e.toString()},\n`})),t+="]\nEDGES: [\n\t",this.edges.forEach((e=>{t+=`\t${e.toString()},\n`})),t+="",t}}let B;L.instance=null;let C,_=null,M=null;const W=(t=>{const e=Object.keys(t);return s=>{e.forEach((e=>{const i=t[e];i&&(s[e]=i.bind(void 0,s))}))}})({preload:t=>{t.loadFont("./font/Regular.otf")},setup:t=>{t.createCanvas(t.windowWidth,t.windowHeight),t.frameRate(30),t.background(248),(t=>{new E(t),new R(t),new x(t),new v(t),new k(t),new N(t),new D(t)})(t),B=L.createInstance(t),I.createInstance()},draw:t=>{C=t,_===C.windowWidth&&M===C.windowHeight||(C.resizeCanvas(C.windowWidth,C.windowHeight),B.resizeCanvas(C.windowWidth,C.windowHeight),_=C.windowWidth,M=C.windowHeight),C.background("rgb(180,180,200)"),B.renderElements()},mouseClicked:function(){B.mouseClicked()},mouseDragged:t=>{L.getInstance().mouseDragged(t)},mousePressed:t=>{L.getInstance().mousePressed(t)},mouseReleased:t=>{L.getInstance().mouseReleased(t)}});new t(W)}(p5);