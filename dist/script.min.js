/**
 * This is a p5.js sketch made with p5js-template-petr-plus.
 *
 * @license CC0-1.0
 */
!function(t){"use strict";class e{constructor(t,e){this.width=t,this.height=e}toString(){return`Dimension:(width:${this.width},  height:${this.height})`}}class s{constructor(t,e,s,i){this.left=t,this.top=e,this.right=s,this.bottom=i}getLeft(){return this.left}getTop(){return this.top}getRight(){return this.right}getBottom(){return this.bottom}getBoundary(){return{left:this.left,top:this.top,right:this.right,bottom:this.bottom}}toString(){return`Boundary=[left: ${this.left}, top: ${this.top}, right: ${this.right}, bottom: ${this.bottom}]`}}class i{constructor(t,e,s,i,o=null,n=null,r=null){this._isClickable=!0,this._isSelectable=!1,this._isDraggable=!1,this._isResizable=!1,this.position=null,this.dimensions=null,this.boundary=null,this.isVisible=!0,this.isSelected=!1,this.isRolledOver=!1,this._isClickable=t,this._isDraggable=e,this._isResizable=s,this._isSelectable=i,o&&this.setPosition(o),n&&this.setDimensions(n),r&&this.setUpBoundary()}checkMouseOver(t,e){const s=this.getBoundary();if(!s)return!1;return t>=s.getLeft()&&t<=s.getRight()&&e>=s.getTop()&&e<=s.getBottom()}getIsDraggable(){return this._isDraggable}getIsClickable(){return this._isClickable}getIsResizable(){return this._isResizable}rolloverAction(){this.isRolledOver=!0}setPosition(t){this.position=t,this.setUpBoundary()}getPosition(){return this.position}setDimensions(t){this.dimensions=t,this.setUpBoundary()}getDimensions(){return this.dimensions}setUpBoundary(t=0){const e=this.getPosition(),i=this.getDimensions();if(null==e||null==i)return;const o=new s(this.position.x-t,this.position.y-t,this.position.x+this.dimensions.width+t,this.position.y+this.dimensions.height+t);this.boundary=o}getBoundary(){return this.boundary}setVisible(t=!0){this.isVisible=t}setHidden(t=!0){this.isVisible=!t}getIsVisible(){return this.isVisible}getIsHidden(){return!this.isVisible}getIsRolledOver(){return this.isRolledOver}setIsRolledOver(t=!0){this.isRolledOver=t}getIsSelected(){return this.isSelected}setIsSelected(t=!0){this.isSelected=t}getIsSelectable(){return this._isSelectable}setSelectable(t=!0){this._isSelectable=t}}class o extends i{constructor(t=null,e=null,s=!1,i=null){super(!0,!0,!0,s,t,e,i),this.isResizable=s,this.isDragging=!1}setCursor(t){let e="pointer";t&&(e="grab");document.getElementById("defaultCanvas0").style.cursor=e}setIsDragging(t){this.isDragging=t}getIsDragging(){return this.isDragging}}class n extends o{doubleClickAction(){throw new Error("Method not implemented.")}constructor(t,e,s,i,o){super(null,null,!1),this.type="Edge",this.sourceNode=null,this.targetNode=null,this.sourcePlug=null,this.targetPlug=null,this.id=t,this.sourceNode=e,s&&(this.targetNode=s),i&&(this.sourcePlug=i),o&&(this.targetPlug=o)}connectSource(t,e=null){this.sourceNode=t,e&&(this.sourcePlug=e)}connectTarget(t,e=null){this.targetNode=t,e&&(this.targetPlug=e)}getSourceNode(){return this.sourceNode}getTargetNode(){return this.targetNode}getSourcePlug(){return this.sourcePlug}getTargetPlug(){return this.targetPlug}getId(){return this.id}dragToPosition(t){throw new Error("Method not implemented.")}clickAction(){throw new Error("Method not implemented.")}toString(){return`EdgeModel: ${this.id}, sourceNode: ${this.sourceNode}, targetNode: ${this.targetNode}, sourcePlug: ${this.sourcePlug}, targetPlug: ${this.targetPlug}`}toDyreqtJson(){throw new Error("EdgeModel-- toDyreqtJson: Method not implemented.")}}class r{constructor(t,e){this.x=t,this.y=e,this.x=t,this.y=e}toString(){return`Position:(x:${this.x}, y:${this.y})`}static getDistance(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}getDistance(t){return r.getDistance(this,t)}}class l extends i{constructor(){super(!0,!1,!1,!1,new r(10,400),new e(300,190)),this.type="Inspector",this.displayedParamSet=[],this.isCollapsed=!1}clickAction(){console.log("inspector pane clicked")}rolloverAction(){}doubleClickAction(){}}class a extends o{doubleClickAction(){throw new Error("Method not implemented.")}constructor(t,e,s,i=null,o=null,n="Tool"){super(i,o,!1),this.name=t,this.type=n,this.name=t,this.icon=e,this.objectType=s,this.setUpBoundary()}getName(){return this.name}getIcon(){return this.icon}getObjectType(){return this.objectType}clickAction(){console.log("tool clicked")}dragToPosition(t){this.setPosition(t)}toString(){return`Tool: ${this.name}, ${this.icon}, ${this.objectType},\n\tPos: ${this.position},\n\tDim:${this.dimensions}`}}class c extends i{doubleClickAction(){throw new Error("Method not implemented.")}constructor(){super(!0,!1,!1,!1,new r(600,10),new e(190,580)),this.type="Toolbox",this.toolList=[],this.isCollapsed=!1,this.initialize()}initialize(){this.toolList.push(new a("Element","E","Element")),this.toolList.push(new a("Subelement","S","Subelement")),this.toolList.push(new a("Edge","E","Edge")),this.setToolLayout()}static findHorizontalCenterLine(t){const e=t.getPosition();return e?e.x+95:0}static findFirstRowOffsetY(t){const e=t.getPosition();if(!e)return 0;return 30+e.y}static findRowCenterLineY(t,e){return this.findFirstRowOffsetY(t)+e*this.ROW_SPACING}static calcNumToolGridColumns(){return 2}static calcNumToolGridRows(){return 6}setToolLayout(){const t=this.getToolList(),s=t.length;for(let i=0;i<s;i++){const s=t[i];s.setDimensions(new e(80,40)),s.setPosition(new r(10+this.position.x+i%2*90,this.position.y+40+50*Math.floor(i/2)))}}getToolList(){return this.toolList}clickAction(){console.log("toolbox clicked")}setIsCollapsed(t=!0){this.isCollapsed=t}getIsCollapsed(){return this.isCollapsed}checkMouseOver(t,e){const s=this.getBoundary();if(!s)return!1;return t>=s.getLeft()&&t<=s.getRight()&&e>=s.getTop()&&e<=s.getBottom()}toString(){return"ToolboxModel"}}c.ROW_SPACING=60;class g{constructor(t){this.width=0,this.height=0,this.width=t.width,this.height=t.height}static positionInspector(t,e){if(null===t)return;const s=t.getDimensions();if(null===s)return;const i=s.height,o=new r(10,e-(i+10));t.setPosition(o)}static positionToolboxAndTools(t,e){if(null===t)return;const s=t.getDimensions();if(null===s)return;const i=s.width,o=new r(e-(i+10),10);t.setPosition(o);const n=t.getToolList();if(null===n)return;const l=n.length;for(let t=0;t<l;t++){const e=n[t];if(null===e.getDimensions())return;const s=10,i=40;e.setPosition(new r(s+o.x+t%2*90,o.y+i+50*Math.floor(t/2)))}}static positionElementBasedOnScreenSize(t,e,s){t instanceof c&&g.positionToolboxAndTools(t,e),t instanceof l&&g.positionInspector(t,s)}createInstance(t){return null===g.instance&&(g.instance=new g(t)),g.instance}getInstance(){if(null===g.instance)throw new Error("Layout instance is not created yet");return g.instance}static getDistance(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}}g.instance=null,g.BASE_NODE_WIDTH=100,g.BASE_NODE_HEIGHT=50;class u extends o{doubleClickAction(){throw new Error("Method not implemented.")}constructor(t,e,s=!1){super(e,null,!1),this.plugPosition=t,this.isHighlit=s,this.type="Plug",this.plugSocket=null,this.plugPosition=t,this.position=e}dragToPosition(t){throw new Error("Method not implemented.")}clickAction(){throw new Error("Method not implemented.")}checkMouseOver(t,e){if(null!==this.position){return g.getDistance(this.position,new r(t,e))<15}return!1}plugIn(t){this.plugSocket=t}toString(){return`Plug: ${this.plugPosition}, position: ${this.position}, plugSocket: ${this.plugSocket}`}setIsHighlit(t=!0){this.isHighlit=t}getIsHighlit(){return this.isHighlit}}const d="N",h="S",p="E",m="W",w="NE",P="NW",f="SE",b="SW";class y extends o{constructor(t,e,s,i,o=[],n=[]){super(s,i),this.id=t,this.label=e,this.position=s,this.dimensions=i,this.inputParameterList=o,this.outputParameterList=n,this.type="Node",this.showNodes=!1,this.isHighlit=!1,this.isEditing=!1,this.id=t,this.label=e,this.position=s,this.dimensions=i,this.plugs=this.createPlugs(),this.setUpBoundary()}getBoundary(){return super.getBoundary()}createPlugs(){const t=[],e=[P,b,f,w,d,h,p,m];for(let s=0;s<8;s++){const i=new u(e[s],this.getPlugPosition(e[s]));t.push(i)}return t}getIsEditing(){return this.isEditing}setLabel(t){this.label=t}setIsEditing(t){this.isEditing=t}setSelected(t=!0){this.isSelected=t}getIsSelected(){return this.isSelected}getPlugPosition(t){const e=this.position.x,s=this.position.y,i=this.dimensions.width,o=this.dimensions.height;switch(t){case P:return new r(e+3,s);case d:return new r(e+3+i/2,s);case w:return new r(e+3+i,s);case b:return new r(e+3,s+o);case h:return new r(e+3+i/2,s+o);case f:return new r(e+3+i,s+o);case m:return new r(e+3,s+o/2);case p:return new r(e+3+i,s+o/2);default:return new r(0,0)}}highlightClosestPlug(t,e){this.plugs.forEach((t=>{t.setIsHighlit(!1)}));const s=this.getPlugClosestToMouse(t,e);s&&s.setIsHighlit()}getPlugClosestToMouse(t,e){let s=null,i=1e5;for(let o=0;o<this.plugs.length;o++){const n=this.plugs[o],l=n.position.getDistance(new r(t,e));l<i&&(i=l,s=n)}return s}getID(){return this.id}getLabel(){return this.label}getShowNodes(){return this.showNodes}getPlugs(){return this.plugs}getSelectedPlugs(){return this.plugs.filter((t=>t.getIsSelected()))}getPlugByPosition(t){return this.plugs.find((e=>e.plugPosition===t))}setIsRolledOver(t=!0){this.isRolledOver=t}getIsRolledOver(){return this.isRolledOver}rolloverAction(){throw this.isRolledOver=!0,this.isHighlit=!0,"NodeModel rolloverAction not implemented"}clickAction(){this.isSelected=!0,this.isHighlit=!0,console.log("NodeModel onClick",this.toString())}doubleClickAction(){this.isEditing=!0,I.setEditTarget(this),console.log("NodeModel doubleClickAction",this.toString())}setUpBoundary(){super.setUpBoundary(10)}setIsDragging(t){this.setCursor(t),this.isDragging=t,this.plugs.forEach((t=>{t.setIsDragging(!0)}))}dragToPosition(t){const e=this.position;this.position=t;const s=t.x-e.x,i=t.y-e.y;this.setUpBoundary(),this.plugs.forEach((t=>{null!==t&&t.setPosition(new r(t.position.x+s,t.position.y+i))}))}getInputParameterList(){return this.inputParameterList}getOutputParameterList(){return this.outputParameterList}addInputParameter(t){this.inputParameterList.push(t)}addOutputParameter(t){this.outputParameterList.push(t)}setInputParameterList(t){this.inputParameterList=t}setOutputParameterList(t){this.outputParameterList=t}getSelectedParameters(){return[...this.inputParameterList,...this.outputParameterList].filter((t=>t.getIsSelected()))}areParamsSelected(){return this.getSelectedParameters().length>0}toString(){return`NodeModel: ${this.id} ${this.label} ${this.position.toString()} ${this.dimensions.toString()}`}toDyreqtJson(){throw new Error("NodeModel-- toDyreqtJson: not yet implemented")}}class T extends i{constructor(t,e,s=null){super(!0,!1,!1,!0),this.isHighlit=!1,this.editingField=null,this.typeColor="blue",this.name=t,this.value=e,this.units=s}getName(){return this.name}getValue(){return this.value}getUnits(){return this.units}getEditingField(){return this.editingField}setValue(t){this.value=t}setUnits(t){this.name=`${this.name} (${t})`}setEditingField(t){this.editingField=t}clickAction(){this.isSelected=!0,this.isHighlit=!0}doubleClickAction(){this.editingField=this.value,this.editingField&&(this.typeColor="red")}toJson(){return JSON.stringify(this)}toString(){let t=`Parameter: ${this.name}, value: ${this.value}`;return null!==this.units&&(t+=`, units: ${this.units}`),t}}class E extends T{constructor(t,e,s=null){super(t,e,s),this.type="InputParameter"}}class S extends T{constructor(t,e,s=null){super(t,e,s),this.type="OutputParameter"}}class k{static createNewObjectFromDynamicTool(t){const e=null==t?void 0:t.getPosition(),s=null==t?void 0:t.getDimensions();return new y("69","new node",e,s)}constructor(){}static createContainer(t,e){const s=document.createElement("div");return s.setAttribute("style","position: absolute; top: 100px; left: 100px; background: #f00; width: 10px; height: 10px;"),e.appendChild(s),{container:s}}static createNodeModel(t,e,s,i){return new y(t,e,s,i)}createPlug(t,e){return new u(t,e)}static populateNodeAndEdgeList(){return{nodes:k.createNodes(),edges:[]}}static createNodes(){const t=[],s=["Solar Array","Cable","Avionics","Radiator"],i=[new E("parameter1",1e3*Math.random(),"meters"),new E("parameter2",69*Math.random(),null),new E("fuel",420*Math.random(),"grams"),new E("Another fourth param","aStringValue: "+(99999*Math.random()).toFixed(3),"count")],o=[new S("parameter1",.5*Math.random(),"meters"),new S("parameter2",6.9*Math.random(),null),new S("fuelRemaining",2*Math.random(),"grams"),new S("Another fourth param","aStringValue: "+(999*Math.random()).toFixed(3),"count")];for(let n=0;n<4;n+=1){const l=(n+1).toString(),a=s[n],c=new r(10+150*n+10*n,20),g=new e(100,50),u=new y(l,a,c,g,i,o);t.push(u)}return t}static createEdges(t){const e=t[0],s=t[1],i=e.getPlugByPosition("E"),o=s.getPlugByPosition("W"),r=new n("e0-1",e,s,i,o),l=t[1],a=t[2],c=l.getPlugByPosition("E"),g=a.getPlugByPosition("W"),u=new n("e1-2",l,a,c,g),d=t[2],h=t[3],p=d.getPlugByPosition("E"),m=h.getPlugByPosition("W");return[r,u,new n("e2-3",d,h,p,m)]}static createInstance(){return k.instance||(k.instance=new k),k.instance}static getInstance(){if(!k.instance)throw new Error("CreationManager instance is not created yet");return k.instance}}class I{static addCharacterToEditTarget(t){null!==this.editTarget&&this.editTarget.setLabel(this.editTarget.getLabel()+t)}static backspaceEditTarget(){if(console.log("backspace"),null===this.editTarget)return;console.log("deleting last character:");const t=this.editTarget.getLabel();console.log("labelContent = ",t);const e=t.slice(0,-1);console.log("bsLabelContent = ",e),this.editTarget.setLabel(e)}constructor(t){this.nodes=[],this.edges=[],this.toolbox=new c,this.inspector=new l,this.dynamicTool=null,this.rolledOverObjects=[],I.setP(t),this.nodes=k.createNodes(),this.edges=k.createEdges(this.nodes)}static getEditTarget(){return I.editTarget}static setEditTarget(t){I.editTarget=t}addNode(t){this.nodes.push(t)}removeNode(t){const e=this.nodes.indexOf(t);e>-1&&this.nodes.splice(e,1)}addEdge(t){this.edges.push(t)}removeEdge(t){const e=this.edges.indexOf(t);e>-1&&this.edges.splice(e,1)}getSelectedNodes(){return this.nodes.filter((t=>t.getIsSelected()))}getSelectedEdges(){return this.edges.filter((t=>t.getIsSelected()))}getSelectedPlugs(){const t=[];return this.nodes.forEach((e=>{t.push(...e.getSelectedPlugs())})),t}getSelectedParameters(){const t=[];return this.nodes.forEach((e=>{t.push(...e.getSelectedParameters())})),t}getRolledOverNodes(){return this.nodes.filter((t=>t.getIsRolledOver()))}getNodes(){return this.nodes}getEdges(){return this.edges}getInspector(){return this.inspector}getToolbox(){return this.toolbox}static createInstance(t){return null===I.instance&&(I.instance=new I(t)),I.instance}static getInstance(t){return null===I.instance&&(console.warn("ApplicationModel instance is null"),I.instance=new I(t)),I.instance}static getP(){return I.p}getDynamicTool(){return this.dynamicTool}setDynamicTool(t){this.dynamicTool=t}setDynamicSlot(t){this.dynamicTool=t}static setP(t){I.p=t}toString(){let t=`ApplicationModel:\n\t${this.nodes.length} nodes,\n\t${this.edges.length}\n`;return t+="NODES: [\n\t",this.nodes.forEach((e=>{t+=`\t${e.toString()},\n`})),t+="]\nEDGES: [\n\t",this.edges.forEach((e=>{t+=`\t${e.toString()},\n`})),t+="",t}}I.instance=null,I.p=null,I.editTarget=null;class v extends a{constructor(t,e,s,i=null,o=null){super(t,e,s,i,o,"DynamicTool")}}class O{static isNonPrintingCharacter(t){return 12!==t&&(13!==t&&(32!==t&&(t<=47||t>=91&&t<=93||t>=112&&t<=123)))}static handleKeyPress(t){if(I.getEditTarget()){if(console.log("keyTyped",t.key,t.keyCode),t.keyCode===t.ENTER&&I.setEditTarget(null),t.keyCode!==t.DELETE&&t.keyCode!==t.BACKSPACE||(console.log("hit backspace"),I.backspaceEditTarget()),this.isNonPrintingCharacter(t.keyCode))return;I.addCharacterToEditTarget(t.key)}}static resizeCanvas(t,e,s){this.repositionElementOnResize(null==t?void 0:t.getToolbox(),e,s),this.repositionElementOnResize(null==t?void 0:t.getInspector(),e,s)}static dragDynamicTool(t,e,s=null){let i=t.getDynamicTool();null===i&&(i=new v(null==s?void 0:s.getName(),null==s?void 0:s.getIcon(),null==s?void 0:s.getObjectType(),null==s?void 0:s.position,null==s?void 0:s.dimensions),t.setDynamicTool(i)),i.dragToPosition(e)}static getClosestPlugsOnSelectedNode(t){const e=t.getSelectedNodes(),s=[];if(e.length>0)for(let t=0;t<e.length;t+=1){const i=I.getP(),o=e[t].getPlugClosestToMouse(i.mouseX,i.mouseY);s.push(o)}return s}selectNode(t){t.setSelected()}static repositionElementOnResize(t,e,s){g.positionElementBasedOnScreenSize(t,e,s)}}class C{static mouseDragged(t,e){const s=this.getDragTarget(e);null!==s&&("Node"===s.type||"Edge"===s.type||"Plug"===s.type||"Tool"===s.type)&&s.setIsDragging(!0)}static checkForSelectParam(t){const e=I.getP();let s=null;return t.checkMouseOver(e.mouseX,e.mouseY)&&(t.setIsSelected(),s=t),s}static checkForSelectPlug(t){const e=t.getPlugs(),s=I.getP();e.forEach((t=>{t.checkMouseOver(s.mouseX,s.mouseY)&&t.setIsSelected()}))}static mouseClicked(t){console.log("mouse clicked");const e=t.getNodes(),s=[];let i=!1;if(t){const o=t.getSelectedNodes();if(o&&o.length>0){const t=o[0].getInputParameterList(),e=o[0].getOutputParameterList();s.push(...t),s.push(...e),console.log(`params.length: ${s.length}`);for(let t=0;t<s.length;t+=1){const e=s[t];void 0!==e&&(i=null!==C.checkForSelectParam(e))}}if(i)return;e.forEach((e=>{C.checkForSelectPlug(e),C.checkForSelectNode(t)}))}}static mouseDoubleClicked(t,e){}static doubleClicked(t){console.log("mouse double clicked"),t.getNodes()}static mousePressed(){}static clearDragTargets(t){t.getNodes().forEach((t=>{t.setIsDragging(!1),t.getPlugs().forEach((t=>t.setIsDragging(!1)))})),t.getEdges().forEach((t=>t.setIsDragging(!1))),t.getToolbox().getToolList().forEach((t=>t.setIsDragging(!1)))}static mouseReleased(t,e){if(null!==e.getDynamicTool()){const t=k.createNewObjectFromDynamicTool(e.getDynamicTool());e.getNodes().push(t),e.setDynamicTool(null)}e.setDynamicTool(null),this.clearDragTargets(e)}static checkForSelectNode(t){const e=t.getNodes(),s=new r(I.getP().mouseX,I.getP().mouseY);for(let t=0;t<e.length;t+=1)if(null!==e[t]&&void 0!==e[t]){const i=e[t];!1===i.areParamsSelected()&&i.setSelected(!1),i.checkMouseOver(s.x,s.y)&&i.setSelected()}}static getDragTarget(t){const e=t.getNodes(),s=t.getEdges(),i=t.getNodes().flatMap((t=>t.getPlugs())),o=t.getToolbox();if(o&&o.getIsRolledOver()){const t=o.getToolList();for(let e=0;e<t.length;e+=1){const s=t[e];if(s.getIsRolledOver())return s}}if(i.length>0)for(let t=0;t<i.length;t+=1){const e=i[t];if(void 0!==e&&(null!==e&&e.getIsRolledOver()))return e}if(s.length>0)for(let t=0;t<s.length;t+=1){const e=s[t];if(void 0!==e&&(null!==e&&(null==e?void 0:e.getIsRolledOver())))return e}if(e.length>0)for(let t=0;t<e.length;t+=1){const s=e[t];if(void 0!==s&&(null!==s&&(null==s?void 0:s.getIsRolledOver())))return s}return null}}class D{constructor(t){D.p=t}static plotConnection(t,s){let i=t.dimensions;t instanceof u&&(i=new e(0,0));let o=s.dimensions;s instanceof u&&(o=new e(0,0));const n=t.position.x+i.width/2,l=t.position.y+i.height/2,a=s.position.x+o.width/2,c=s.position.y+o.height/2,g=n+(a-n)/2,d=g,h=c,p=new r(g,l),m=new r(d,h);return[new r(n,l),p,m,new r(a,c)]}static renderLines(t,e="rgb(200,0,0)"){const s=D.p;s.push(),s.noFill(),s.strokeWeight(3),s.stroke(e);for(let e=1;e<t.length;e+=1){const i=t[e-1],o=t[e];s.line(i.x,i.y,o.x,o.y)}s.pop()}static render(t){const e=t.getSourcePlug(),s=t.getTargetPlug();let i=[];if(null===e||null===s){const e=t.getSourceNode(),s=t.getTargetNode();i=this.plotConnection(e,s)}else{const e=t.getSourcePlug(),s=t.getTargetPlug();i=this.plotConnection(e,s)}this.renderLines(i)}}class R{constructor(t){R.p=t}static render(){const t=R.p;t.push(),t.noFill(),t.strokeWeight(1),t.stroke("rgb(255,255,255,0.5)");for(let e=1;e<t.width/100;e+=1)t.line(100*e,0,100*e,t.height);for(let e=1;e<t.height/100;e+=1)t.line(0,100*e,t.width,100*e);t.pop()}static getP(){return R.p}}const N="VALUE";class x{constructor(t){x.p=t}static drawColumnDivider(t){const e=this.p,s=t.getPosition();if(null===e)throw new Error("p is null in RenderParameter");e.push(),e.noStroke(),e.translate(s.x+5,s.y+this.Y_FIRST_ROW_OFFSET),e.stroke(72),e.strokeWeight(1);const i=this.NAME_COLUMN_WIDTH-10,o=i,n=t.boundary.getBottom();e.line(i,-15,o,n),e.noStroke(),e.pop()}static renderText(t,e){const s=this.p,i=e.getPosition();if(null===s)throw new Error("p is null in RenderParameter");s.push(),s.translate(i.x+5,i.y+this.Y_FIRST_ROW_OFFSET+this.rowCount*this.Y_EACH_ROW_OFFSET),s.fill(0),s.text(t.getName(),0,0);let o=t.getValue();"number"==typeof o&&(o=o.toFixed(3)),t.getUnits()&&(o+=` ${t.getUnits()}`),t.getEditingField()===N&&s.fill("rgba(200,0,0,1)"),s.text(o,this.NAME_COLUMN_WIDTH,0),s.pop()}static setParameterPosition(t,e,s){const i=e.getPosition();t.setPosition(new r(i.x,i.y+7+s*this.Y_EACH_ROW_OFFSET))}static setParameterDimensions(t,s){t.setDimensions(new e(s.dimensions.width,this.Y_EACH_ROW_OFFSET))}static renderParameterRowInInspector(t,e,s=!1,i=!1){if(s&&(x.rowCount=0,this.addHorizontalDivider(e,"Input Parameters")),i&&this.addHorizontalDivider(e,"Output Parameters"),x.rowCount>=8)return;if(null===x.p)throw new Error("p is null in RenderParameter");this.renderText(t,e),x.rowCount+=1}static addHorizontalDivider(t,e=null){const s=this.p,i=t.getPosition();if(null===s)throw new Error("p is null in RenderParameter");if(null===i)throw new Error("inspector position is null in RenderParameter");s.push(),"Output Parameters"===e?s.fill("rgba(11,255,11,1)"):s.fill("rgba(255,255,148,1)"),s.translate(t.boundary.getLeft()+2,t.boundary.getTop()+this.rowCount*this.Y_EACH_ROW_OFFSET+30),s.rect(0,0,t.boundary.getRight()-15,this.Y_EACH_ROW_OFFSET),s.fill(0),null!==e&&(s.text(e,5,15),s.stroke(0),s.strokeWeight(.5),s.line(5,18,.9*t.dimensions.width,18)),s.pop(),x.rowCount+=1}static drawOverPositionAndDimensions(t){const e=this.p;if(null===e)throw new Error("p is null in RenderParameter");e.push(),e.translate(t.position.x,t.position.y),e.fill("rgba(255,100,0,1)"),e.circle(0,0,5),e.noFill(),e.stroke("rgba(0,255,255,0.7)"),e.strokeWeight(1);const s=e.rect(0,0,t.dimensions.width,t.dimensions.height);s.mouseClicked=()=>{t.clickAction()},s.doubleClicked=()=>{t.doubleClickAction()},e.pop()}static render(t,e,s=!1,i=!1){x.setParameterPosition(t,e,x.rowCount),x.setParameterDimensions(t,e),x.drawOverPositionAndDimensions(t);const o=this.p;if(null===o)throw new Error("p is null in RenderParameter");o.push(),o.translate(e.boundary.getLeft(),e.boundary.getTop()),o.pop(),this.renderParameterRowInInspector(t,e,s,i)}}x.p=null,x.rowCount=0,x.Y_FIRST_ROW_OFFSET=45,x.Y_EACH_ROW_OFFSET=20,x.NAME_COLUMN_WIDTH=150;class L{constructor(t){L.p=t}static render(t,e){let s=[],i=[];if(e&&(s=e.getInputParameterList(),i=e.getOutputParameterList()),t){L.renderBackground(t),L.renderInspectorBorder(t),L.renderTitleBar(t);const e=s.length;for(let i=0;i<e;i+=1)x.render(s[i],t,0===i);const o=i.length;for(let e=0;e<o;e+=1)x.render(i[e],t,!1,0===e)}else console.warn("InspectorModel is null")}static renderTitle(t){const e=L.getP(),s=t.getPosition();s&&(e.push(),e.fill(255),e.noStroke(),e.text("Object Inspector",s.x+10,s.y+20),e.push())}static renderTitleBar(t){const e=L.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(32,32,64,0.8)"),e.noStroke(),e.rect(s.x,s.y,i.width,30),e.pop(),L.renderTitle(t))}static renderBackground(t){const e=L.getP();if(t){const s=t.getPosition(),i=t.getDimensions();if(!s||!i)return;e.push(),e.fill("rgba(255,255,255,0.9)"),e.noStroke(),e.rect(s.x,s.y+30,i.width,i.height-30),e.pop()}else console.warn("InspectorModel is null")}static renderInspectorBorder(t){const e=L.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.noFill(),e.stroke("rgba(32,32,64,0.8)"),e.strokeWeight(3),e.rect(s.x,s.y,i.width,i.height),e.pop())}static getP(){return L.p}}class B{constructor(t){this.isSelected=!1,B.p=t}static renderPlug(t,e,s){if(null===t)return;const i=t.getPosition();if(null===i)return;const o=t.getIsSelected(),n=i.x,r=i.y;let l="rgba(200,200,200,0.7)",a="rgba(255,255,200,0.7)";t.checkMouseOver(e.mouseX,e.mouseY)&&(l="rgba(255,255,72,1)",a="rgba(0,0,0,0.8)"),o&&(l="rgba(255,0,72,1)",a="rgba(255,0,72,1)"),t.getIsHighlit()&&(l="rgba(0,0,255,1)",a="rgba(0,255,255,1)"),e.push(),e.stroke(l),e.strokeWeight(2),e.fill(a),(o||s)&&e.circle(n,r,8),e.pop()}static showNodes(t,e,s){t.getPlugs().forEach((t=>{this.renderPlug(t,e,s)}))}static render(t,e,s=!1){const i=10;t.getBoundary();const o=t.dimensions.width,n=t.dimensions.height,r=t.position.x,l=t.position.y,a=t.getLabel();let c="rgba(228,200,200,1)";t.getIsSelected()&&(c="rgba(255,255,200,1)"),e.push(),e.translate(r,l),e.noStroke(),e.fill("rgba(0,0,0,0.5)");let g="rgb(128,128,128)",u=1;s&&(g="rgb(255,200,0)",u=3);const d=e.rect(0,5,o,n,0,i,i,i);e.fill(c),e.stroke(g),e.strokeWeight(u),e.rect(3,0,o,n,0,i,i,i),t.getIsEditing()?e.fill("rgba(200,0,0,1)"):e.fill(0),e.noStroke(),e.textAlign(e.CENTER,e.CENTER),e.text(a,6,3,o-6,n-6),t.getIsEditing()&&(e.noFill(),e.stroke("rgba(0,0,200,1)"),e.rect(10,10,o-10,n-20)),e.pop();const h=t.getIsRolledOver();this.showNodes(t,e,h),B.drawRolloverGuide(t.getBoundary(),e),d.mouseClicked=()=>{t.clickAction()},d.doubleClicked=()=>{t.doubleClickAction()}}static drawRolloverGuide(t,e){e.push(),e.noFill(),e.stroke("rgb(0,255,255)"),e.strokeWeight(1),null!==t?(e.translate(t.getLeft(),t.getTop()),e.rect(0,0,t.getRight()-t.getLeft(),t.getBottom()-t.getTop()),e.pop()):console.warn("boundary is null in RenderNode.drawRolloverGuide")}}class M{constructor(t){M.p=t}static getP(){return M.p}static drawRolloverGuide(t,e){e.push(),e.noFill(),e.stroke("rgb(0,255,255)"),e.strokeWeight(1),null!==t?(e.translate(t.getLeft(),t.getTop()),e.rect(0,0,t.getRight()-t.getLeft(),t.getBottom()-t.getTop()),e.pop()):console.warn("boundary is null in RenderNode.drawRolloverGuide")}static render(t){const e=M.getP(),s=null==t?void 0:t.getBoundary();e.push();const i=null==t?void 0:t.getPosition(),o=null==t?void 0:t.getPosition();null!==i&&null!==o&&void 0!==i&&void 0!==o?("DynamicTool"===(null==t?void 0:t.type)?e.fill("rgba(255,255,0,1)"):"Tool"===(null==t?void 0:t.type)?e.fill("rgba(100,100,255,1)"):e.fill("rgba(128,0,255,1)"),e.stroke(72),e.strokeWeight(2),e.translate(s.getLeft(),s.getTop()),e.rect(0,0,s.getRight()-s.getLeft(),s.getBottom()-s.getTop()),e.noStroke(),e.fill(255),e.text(t.getName(),5,5,s.getRight()-s.getLeft(),s.getBottom()-s.getTop()),e.pop(),null!==s?this.drawRolloverGuide(s,e):console.warn("boundary is null in RenderTool.render")):console.warn("tool position data is null")}}class A{constructor(t){A.p=t}static getP(){return A.p}static renderTitle(t){const e=A.getP(),s=t.getPosition();s&&(e.push(),e.fill(255),e.noStroke(),e.text("TOOLBOX",s.x+10,s.y+20),e.push())}static renderTitleBar(t){const e=A.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(32,32,64,0.8)"),e.noStroke(),e.rect(s.x,s.y,i.width,30),e.fill(255),e.text("TOOLBOX",s.x+10,s.y+20),e.pop(),A.renderTitle(t))}static renderTools(t){t.getToolList().forEach((t=>{M.render(t)}))}static render(t){t?(A.renderBackground(t),A.renderTBBorder(t),A.renderTitleBar(t),A.renderTools(t)):console.warn("RenderToolbox.render: tbm is null")}static renderBackground(t){const e=A.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(255,255,255,0.85)"),e.noStroke(),e.rect(s.x,s.y+30,i.width,i.height-30),e.pop())}static renderTBBorder(t){const e=A.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.noFill(),e.stroke("rgba(32,32,64,0.8)"),e.strokeWeight(3),e.rect(s.x,s.y,i.width,i.height))}}class _{constructor(t){_.p=t}static renderNodes(t,e){const s=null==e?void 0:e.getNodes();null==s||s.forEach((e=>{e.checkMouseOver(t.mouseX,t.mouseY)?e.setIsRolledOver():e.setIsRolledOver(!1),e.getIsDragging()&&e.dragToPosition(new r(t.mouseX-40,t.mouseY-20)),B.render(e,I.getP())}))}static drawLeadLine(t,e,s,i){const o=[s,i];D.renderLines(o,"rgb(0,128,255)")}static renderElements(t){const e=I.getP(),s=null==t?void 0:t.getToolbox(),i=null==t?void 0:t.getInspector(),o=null==t?void 0:t.getDynamicTool();A.render(s),L.render(i,null==t?void 0:t.getSelectedNodes()[0]);(null==s?void 0:s.checkMouseOver(e.mouseX,e.mouseY))&&(null==s||s.setIsRolledOver()),this.renderTools(e,t),this.renderEdges(t),this.renderNodes(e,t),null!==o&&M.render(o),R.render()}static renderEdges(t){const e=t.getEdges();null==e||e.forEach((t=>{D.render(t)}))}static renderTools(t,e){const s=e.getToolbox();null==s||s.getToolList().forEach((s=>{s.getIsDragging()&&O.dragDynamicTool(e,new r(t.mouseX-40,t.mouseY-20),s);s.checkMouseOver(t.mouseX,t.mouseY)?s.setIsRolledOver():s.setIsRolledOver(!1)}))}}_.p=null;let F=null;let W,H=null,$=null;const Y=(t=>{const e=Object.keys(t);return s=>{e.forEach((e=>{const i=t[e];i&&(s[e]=i.bind(void 0,s))}))}})({preload:t=>{F=I.createInstance(t),t.loadFont("./font/Regular.otf")},setup:t=>{t.createCanvas(t.windowWidth,t.windowHeight),t.frameRate(30),t.background(248),(t=>{new B(t),new D(t),new R(t),new M(t),new A(t),new L(t),new x(t),new _(t)})(t)},draw:t=>{W=t,H===W.windowWidth&&$===W.windowHeight||(W.resizeCanvas(W.windowWidth,W.windowHeight),O.resizeCanvas(F,W.windowWidth,W.windowHeight),H=W.windowWidth,$=W.windowHeight),W.background("rgb(180,180,200)"),_.renderElements(F)},mouseClicked:function(){C.mouseClicked(F)},mouseDragged:t=>{C.mouseDragged(t,F)},mousePressed:()=>{},mouseReleased:t=>{C.mouseReleased(t,F)},keyPressed:t=>{O.handleKeyPress(t)}});new t(Y)}(p5);