/**
 * This is a p5.js sketch made with p5js-template-petr-plus.
 *
 * @license CC0-1.0
 */
!function(t){"use strict";class e{constructor(t,e){this.width=t,this.height=e}toString(){return`Dimension:(width:${this.width},  height:${this.height})`}}class s{constructor(t,e,s,i){this.left=t,this.top=e,this.right=s,this.bottom=i}getLeft(){return this.left}getTop(){return this.top}getRight(){return this.right}getBottom(){return this.bottom}getBoundary(){return{left:this.left,top:this.top,right:this.right,bottom:this.bottom}}toString(){return`Boundary=[left: ${this.left}, top: ${this.top}, right: ${this.right}, bottom: ${this.bottom}]`}}class i{constructor(t,e,s,i,n=null,o=null,r=null){this._isClickable=!0,this._isSelectable=!1,this._isDraggable=!1,this._isResizable=!1,this.position=null,this.dimensions=null,this.boundary=null,this.isVisible=!0,this.isSelected=!1,this.isRolledOver=!1,this._isClickable=t,this._isDraggable=e,this._isResizable=s,this._isSelectable=i,n&&this.setPosition(n),o&&this.setDimensions(o),r&&this.setUpBoundary()}checkBoundary(t,e,s=!1){const i=this.getBoundary();if(s&&console.log("checkBoundary: "+i),!i)return!1;return t>=i.getLeft()&&t<=i.getRight()&&e>=i.getTop()&&e<=i.getBottom()}getIsDraggable(){return this._isDraggable}getIsClickable(){return this._isClickable}getIsResizable(){return this._isResizable}rolloverAction(){this.isRolledOver=!0}setPosition(t){this.position=t,this.setUpBoundary()}getPosition(){return this.position}setDimensions(t){this.dimensions=t,this.setUpBoundary()}getDimensions(){return this.dimensions}setUpBoundary(t=0){const e=this.getPosition(),i=this.getDimensions();if(null==e||null==i)return;const n=new s(this.position.x-t,this.position.y-t,this.position.x+this.dimensions.width+t,this.position.y+this.dimensions.height+t);this.boundary=n}getBoundary(){return this.boundary}setVisible(t=!0){this.isVisible=t}setHidden(t=!0){this.isVisible=!t}getIsVisible(){return this.isVisible}getIsHidden(){return!this.isVisible}getIsRolledOver(){return this.isRolledOver}setIsRolledOver(t=!0){this.isRolledOver=t}getIsSelected(){return this.isSelected}setIsSelected(t=!0){this.isSelected=t}getIsSelectable(){return this._isSelectable}setSelectable(t=!0){this._isSelectable=t}}class n extends i{constructor(t=null,e=null,s=!1,i=null){super(!0,!0,!0,s,t,e,i),this.isResizable=s,this.isDragging=!1}setCursor(t){let e="pointer";t&&(e="grab");document.getElementById("defaultCanvas0").style.cursor=e}setIsDragging(t){this.isDragging=t}getIsDragging(){return this.isDragging}}class o extends n{doubleClickAction(){throw new Error("Method not implemented.")}constructor(t,e,s,i,n){super(null,null,!1),this.type="Edge",this.sourceNode=null,this.targetNode=null,this.sourcePlug=null,this.targetPlug=null,this.id=t,this.sourceNode=e,s&&(this.targetNode=s),i&&(this.sourcePlug=i),n&&(this.targetPlug=n)}connectSource(t,e=null){this.sourceNode=t,e&&(this.sourcePlug=e)}connectTarget(t,e=null){this.targetNode=t,e&&(this.targetPlug=e)}getSourceNode(){return this.sourceNode}getTargetNode(){return this.targetNode}getSourcePlug(){return this.sourcePlug}getTargetPlug(){return this.targetPlug}getId(){return this.id}dragToPosition(t){throw new Error("Method not implemented.")}clickAction(){throw new Error("Method not implemented.")}toString(){return`EdgeModel: ${this.id}, sourceNode: ${this.sourceNode}, targetNode: ${this.targetNode}, sourcePlug: ${this.sourcePlug}, targetPlug: ${this.targetPlug}`}toDyreqtJson(){throw new Error("EdgeModel-- toDyreqtJson: Method not implemented.")}}class r{constructor(t,e){this.x=t,this.y=e,this.x=t,this.y=e}toString(){return`Position:(x:${this.x}, y:${this.y})`}static getDistance(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}getDistance(t){return r.getDistance(this,t)}}class l extends i{constructor(t){super(!0,!1,!1,!1),this.rowNum=t}}class c extends l{constructor(t,e){super(e),this.content=t}clickAction(){}doubleClickAction(){}getContent(){return this.content}setContent(t){this.content=t}toString(){return`InspectorRowHeading[${this.content}]`}}class a extends i{constructor(t,e){super(!0,!1,!1,!0),this.content=t,this.columnNum=e}getContent(){return this.content}setContent(t){this.content=t}clickAction(){console.log("Inspector Info Column: click action")}doubleClickAction(){console.log("Inspector Info Column: double-click action")}getColumnNum(){return this.columnNum}setColumnNum(t){this.columnNum=t}}class g extends l{constructor(t,e){super(e),this.columns=[new a(t.getName(),0),new a(`${t.getValue()} ${t.getUnits()}`,1)]}getColumns(){return this.columns}clickAction(){throw new Error("Method not implemented.")}doubleClickAction(){throw new Error("Method not implemented.")}toString(){var t;return`InspectorRowInfo[${null===(t=this.columns[0])||void 0===t?void 0:t.getContent()}]`}}class u{static assignBoundariesToRows(t){t.forEach((t=>{t.setUpBoundary()}))}constructor(t,e){u.position=t,u.dimensions=e,u.Y_POSITION=w.getHeight()-200,u.layout=w.getInstance()}static createInstance(t,e){return u.instance=new u(t,e),u.instance}static getInstance(){if(null===u.instance)throw new Error("InspectorLayout instance is null");return u.instance}static getPosition(){return u.position}static getDimensions(){return u.dimensions}static createRowsFromInputAndOutputParameters(t,e){let s=0;const i=[],n=new c("Input Parameters",s+=1),o=t.map((t=>new g(t,s+=1))),r=new c("Output Parameters",s+=1),l=e.map((t=>new g(t,s+=1)));return i.push(n),i.push(...o),i.push(r),i.push(...l),i}static assignDimensionsToRows(t,s=this.ROW_WIDTH,i=this.ROW_HEIGHT){return t.forEach((t=>t.setDimensions(new e(s,i)))),t}static assignPositionsToRows(t,e=u.ROW_HEIGHT,s=0,i=0,n=this.Y_FIRST_ROW_OFFSET){return t.forEach(((t,o)=>t.setPosition(u.calcRowPosition(o,e,s,i,n)))),t}static calcRowPosition(t,e,s=0,i=0,n=0){return new r(s,i+t*e+n)}static setParameterDimensions(t,s){t.setDimensions(new e(s.dimensions.width,this.ROW_HEIGHT))}}u.DEFAULT_INSPECTOR_WIDTH=600,u.DEFAULT_INSPECTOR_HEIGHT=300,u.X_POSITION=10,u.Y_FIRST_ROW_OFFSET=30,u.ROW_HEIGHT=30,u.ROW_WIDTH=600,u.Y_TABLE_START=20,u.PARAM_NAME_COLUMN_WIDTH=150,u.instance=null,u.position=new r(0,0),u.dimensions=new e(0,0);class h{constructor(t){const e=t.getInputParameterList(),s=t.getOutputParameterList();this.numCols=2,this.rows=this.buildTable(e,s)}getNumRows(){return this.rows.length}getNumCols(){return this.numCols}buildTable(t,e){const s=u.createRowsFromInputAndOutputParameters(t,e);return u.assignDimensionsToRows(s),u.assignPositionsToRows(s),u.assignBoundariesToRows(s),console.log(`row[1] boundary: ${s[1].getBoundary()}`),s}getRow(t){return this.rows[t]instanceof c||this.rows[t]instanceof g?this.rows[t]:null}getInfoRows(){return this.rows.filter((t=>t instanceof g))}toString(){var t;let e="";for(let s=0;s<this.rows.length;s++)e+=(null===(t=this.rows[s])||void 0===t?void 0:t.toString())+"\n";return e}}class d extends i{constructor(){super(!0,!1,!1,!1,u.getPosition(),u.getDimensions()),this.type="Inspector",this.displayedParamSet=[],this.isCollapsed=!1,this.inspectorTable=null}createTable(t){this.inspectorTable=new h(t)}getTable(){return this.inspectorTable}clickAction(){console.log("inspector pane clicked")}rolloverAction(){}doubleClickAction(){}}class p extends n{doubleClickAction(){throw new Error("Method not implemented.")}constructor(t,e,s,i=null,n=null,o="Tool"){super(i,n,!1),this.name=t,this.type=o,this.name=t,this.icon=e,this.objectType=s,this.setUpBoundary()}getName(){return this.name}getIcon(){return this.icon}getObjectType(){return this.objectType}clickAction(){console.log("tool clicked")}dragToPosition(t){this.setPosition(t)}toString(){return`Tool: ${this.name}, ${this.icon}, ${this.objectType},\n\tPos: ${this.position},\n\tDim:${this.dimensions}`}}class m extends i{doubleClickAction(){throw new Error("Method not implemented.")}constructor(){super(!0,!1,!1,!1,new r(600,10),new e(190,580)),this.type="Toolbox",this.toolList=[],this.isCollapsed=!1,this.initialize()}initialize(){this.toolList.push(new p("Element","E","Element")),this.toolList.push(new p("Subelement","S","Subelement")),this.toolList.push(new p("Edge","E","Edge")),this.setToolLayout()}static findHorizontalCenterLine(t){const e=t.getPosition();return e?e.x+95:0}static findFirstRowOffsetY(t){const e=t.getPosition();if(!e)return 0;return 30+e.y}static findRowCenterLineY(t,e){return this.findFirstRowOffsetY(t)+e*this.ROW_SPACING}static calcNumToolGridColumns(){return 2}static calcNumToolGridRows(){return 6}setToolLayout(){const t=this.getToolList(),s=t.length;for(let i=0;i<s;i++){const s=t[i];s.setDimensions(new e(80,40)),s.setPosition(new r(10+this.position.x+i%2*90,this.position.y+40+50*Math.floor(i/2)))}}getToolList(){return this.toolList}clickAction(){console.log("toolbox clicked")}setIsCollapsed(t=!0){this.isCollapsed=t}getIsCollapsed(){return this.isCollapsed}checkBoundary(t,e){const s=this.getBoundary();if(!s)return!1;return t>=s.getLeft()&&t<=s.getRight()&&e>=s.getTop()&&e<=s.getBottom()}toString(){return"ToolboxModel"}}m.ROW_SPACING=60;class w{constructor(t,e){w.width=t,w.height=e,w.positionPanel(C.getInstance().getInspector()),w.positionPanel(C.getInstance().getToolbox())}static resizeCanvas(t,e){this.width=t,this.height=e}static calcInspectorPosition(t){if(null===t)return;t.setDimensions(new e(600,300));const s=new r(10,this.height-310);t.setPosition(s)}static positionToolboxAndTools(t,e){if(null===t)return;const s=t.getDimensions();if(null===s)return;const i=s.width,n=new r(e-(i+10),10);t.setPosition(n);const o=t.getToolList();if(null===o)return;const l=o.length;for(let t=0;t<l;t++){const e=o[t];if(null===e.getDimensions())return;const s=10,i=40;e.setPosition(new r(s+n.x+t%2*90,n.y+i+50*Math.floor(t/2)))}}static positionPanel(t){if(0===this.width||0===this.height)throw new Error("Layout dimensions are not set");t instanceof m&&w.positionToolboxAndTools(t,this.width),t instanceof d&&w.calcInspectorPosition(t)}static createInstance(t,e){return null===w.instance&&(w.instance=new w(t,e)),w.instance}static getInstance(){return null===w.instance&&(w.instance=new w(0,0)),w.instance}static getDistance(t,e){const s=t.x-e.x,i=t.y-e.y;return Math.sqrt(s*s+i*i)}static getWidth(){return w.width}static getHeight(){return w.height}}w.instance=null,w.BASE_NODE_WIDTH=100,w.BASE_NODE_HEIGHT=50,w.width=0,w.height=0;class f extends n{doubleClickAction(){throw new Error("Method not implemented.")}constructor(t,e,s=!1){super(e,null,!1),this.plugPosition=t,this.isHighlit=s,this.type="Plug",this.plugSocket=null,this.plugPosition=t,this.position=e}dragToPosition(t){throw new Error("Method not implemented.")}clickAction(){throw new Error("Method not implemented.")}checkBoundary(t,e){if(null!==this.position){return w.getDistance(this.position,new r(t,e))<15}return!1}plugIn(t){this.plugSocket=t}toString(){return`Plug: ${this.plugPosition}, position: ${this.position}, plugSocket: ${this.plugSocket}`}setIsHighlit(t=!0){this.isHighlit=t}getIsHighlit(){return this.isHighlit}}const P="N",T="S",I="E",b="W",y="NE",k="NW",E="SE",R="SW";class v extends n{constructor(t,e,s,i,n=[],o=[]){super(s,i),this.id=t,this.label=e,this.position=s,this.dimensions=i,this.inputParameterList=n,this.outputParameterList=o,this.type="Node",this.showNodes=!1,this.isHighlit=!1,this.isEditing=!1,this.id=t,this.label=e,this.position=s,this.dimensions=i,this.plugs=this.createPlugs(),this.setUpBoundary()}getBoundary(){return super.getBoundary()}createPlugs(){const t=[],e=[k,R,E,y,P,T,I,b];for(let s=0;s<8;s++){const i=new f(e[s],this.getPlugPosition(e[s]));t.push(i)}return t}getIsEditing(){return this.isEditing}setLabel(t){this.label=t}setIsEditing(t){console.log("setIsEditing: "+t),this.isEditing=t}getIsSelected(){return this.isSelected}getPlugPosition(t){const e=this.position.x,s=this.position.y,i=this.dimensions.width,n=this.dimensions.height;switch(t){case k:return new r(e+3,s);case P:return new r(e+3+i/2,s);case y:return new r(e+3+i,s);case R:return new r(e+3,s+n);case T:return new r(e+3+i/2,s+n);case E:return new r(e+3+i,s+n);case b:return new r(e+3,s+n/2);case I:return new r(e+3+i,s+n/2);default:return new r(0,0)}}highlightClosestPlug(t,e){this.plugs.forEach((t=>{t.setIsHighlit(!1)}));const s=this.getPlugClosestToMouse(t,e);s&&s.setIsHighlit()}getPlugClosestToMouse(t,e){let s=null,i=1e5;for(let n=0;n<this.plugs.length;n++){const o=this.plugs[n],l=o.position.getDistance(new r(t,e));l<i&&(i=l,s=o)}return s}getID(){return this.id}getLabel(){return this.label}getShowNodes(){return this.showNodes}getPlugs(){return this.plugs}getSelectedPlugs(){return this.plugs.filter((t=>t.getIsSelected()))}getPlugByPosition(t){return this.plugs.find((e=>e.plugPosition===t))}setIsRolledOver(t=!0){this.isRolledOver=t}getIsRolledOver(){return this.isRolledOver}rolloverAction(){throw this.isRolledOver=!0,this.isHighlit=!0,"NodeModel rolloverAction not implemented"}clickAction(){this.isSelected=!0,this.isHighlit=!0;C.getInstance().getInspector().createTable(this)}doubleClickAction(){this.isEditing=!0,C.setEditTarget(this)}setUpBoundary(){super.setUpBoundary(10)}setIsDragging(t){this.setCursor(t),this.isDragging=t,this.plugs.forEach((t=>{t.setIsDragging(!0)}))}dragToPosition(t){const e=this.position;this.position=t;const s=t.x-e.x,i=t.y-e.y;this.setUpBoundary(),this.plugs.forEach((t=>{null!==t&&t.setPosition(new r(t.position.x+s,t.position.y+i))}))}getInputParameterList(){return this.inputParameterList}getOutputParameterList(){return this.outputParameterList}addInputParameter(t){this.inputParameterList.push(t)}addOutputParameter(t){this.outputParameterList.push(t)}setInputParameterList(t){this.inputParameterList=t}setOutputParameterList(t){this.outputParameterList=t}getSelectedParameters(){return[...this.inputParameterList,...this.outputParameterList].filter((t=>t.getIsSelected()))}areParamsSelected(){return this.getSelectedParameters().length>0}toString(){return`NodeModel: ${this.id} ${this.label} ${this.position.toString()} ${this.dimensions.toString()}`}toDyreqtJson(){throw new Error("NodeModel-- toDyreqtJson: not yet implemented")}}class S extends i{constructor(t,e,s=null){super(!0,!1,!1,!0),this.isHighlit=!1,this.editingField=null,this.typeColor="blue",this.name=t,this.value=e,this.units=s}getName(){return this.name}getValue(){return this.value}getUnits(){return this.units}getEditingField(){return this.editingField}setValue(t){this.value=t}setUnits(t){this.name=`${this.name} (${t})`}setEditingField(t){this.editingField=t}clickAction(){this.isSelected=!0,this.isHighlit=!0}toJson(){return JSON.stringify(this)}toString(){let t=`Parameter: ${this.name}, value: ${this.value}`;return null!==this.units&&(t+=`, units: ${this.units}`),t}}class D extends S{doubleClickAction(t){this.isEditing=!0,C.setEditTarget(this.value)}constructor(t,e,s=null,i=!1){super(t,e,s),this.isEditing=i,this.type="InputParameter"}getValue(){return this.value}setValue(t){this.value=t}getIsEditing(){return this.isEditing}setIsEditing(t){this.isEditing=t}}class N extends S{doubleClickAction(t){this.isEditing=!0,C.setEditTarget(this.value)}constructor(t,e,s=null,i=!1){super(t,e,s),this.isEditing=i,this.type="OutputParameter",this.isEditing=i}getValue(){return this.value}setValue(t){this.value=t}getIsEditing(){return this.isEditing}setIsEditing(t){this.isEditing=t}}class O{static createNewObjectFromDynamicTool(t){const e=null==t?void 0:t.getPosition(),s=null==t?void 0:t.getDimensions();return new v("69","new node",e,s)}static tryToMakeConnection(){const t=C.getInstance(),e=C.getInstance().getSelectedPlugs();if(e&&2===e.length){const s=e[0],i=e[1],n=t.getPlugParent(s),r=t.getPlugParent(i),l=new o(Math.floor(1e5*Math.random()).toString(),n,r,s,i);C.getInstance().addEdge(l),C.getInstance().clearPlugsSelected()}}static advanceState(){this.tryToMakeConnection()}constructor(){}static createContainer(t,e){const s=document.createElement("div");return s.setAttribute("style","position: absolute; top: 100px; left: 100px; background: #f00; width: 10px; height: 10px;"),e.appendChild(s),{container:s}}static createNodeModel(t,e,s,i){return new v(t,e,s,i)}createPlug(t,e){return new f(t,e)}static createNodes(){const t=[],s=["Solar Array","Cable","Avionics","Radiator"],i=[new D("parameter1",1e3*Math.random(),"meters"),new D("parameter2",69*Math.random(),null),new D("fuel",420*Math.random(),"grams"),new D("Another fourth param","aStringValue: "+(99999*Math.random()).toFixed(3),"count")],n=[new N("parameter1",.5*Math.random(),"meters"),new N("parameter2",6.9*Math.random(),null),new N("fuelRemaining",2*Math.random(),"grams"),new N("Another fourth param","aStringValue: "+(999*Math.random()).toFixed(3),"count")];for(let o=0;o<4;o+=1){const l=(o+1).toString(),c=s[o],a=new r(10+150*o+10*o,20),g=new e(100,50),u=new v(l,c,a,g,i,n);t.push(u)}return t}static createEdges(t){const e=t[0],s=t[1],i=e.getPlugByPosition("E"),n=s.getPlugByPosition("W"),r=new o("e0-1",e,s,i,n),l=t[1],c=t[2],a=l.getPlugByPosition("E"),g=c.getPlugByPosition("W"),u=new o("e1-2",l,c,a,g),h=t[2],d=t[3],p=h.getPlugByPosition("E"),m=d.getPlugByPosition("W");return[r,u,new o("e2-3",h,d,p,m)]}static createInstance(){return O.instance||(O.instance=new O),O.instance}static getInstance(){if(!O.instance)throw new Error("CreationManager instance is not created yet");return O.instance}}class C{clearPlugsSelected(){const t=this.getNodes();if(t.length>0)for(let e=0;e<t.length;e++){t[e].getPlugs().forEach((t=>{t.setIsSelected(!1)}))}}getPlugParent(t){var e;const s=this.getNodes().filter((e=>e.getPlugs().includes(t)));if(s.length>0)for(let i=0;i<s.length;i++)if(null===(e=s[i])||void 0===e?void 0:e.getPlugs().includes(t))return s[i];return null}getDraggingNodes(){return this.getNodes().filter((t=>t.getIsDragging()))}constructor(){this.nodes=[],this.edges=[],this.toolbox=new m,this.inspector=new d,this.dynamicTool=null,this.rolledOverObjects=[],this.initializeForDev()}initializeForDev(){this.nodes=O.createNodes(),this.edges=[]}static addCharacterToEditTarget(t){null!==this.editTarget&&(this.editTarget instanceof v&&this.editTarget.setLabel(this.editTarget.getLabel()+t),(this.editTarget instanceof D||this.editTarget instanceof N)&&this.editTarget.setValue(this.editTarget.getValue()+t))}static backspaceEditTarget(){if(null===this.editTarget)return;let t=null,e=null;if(this.editTarget instanceof v?(t=this.editTarget.getLabel(),e=this.editTarget.setLabel):(this.editTarget instanceof D||this.editTarget instanceof N)&&(t=this.editTarget.getValue(),e=this.editTarget.setValue),null===t)return;if(null===e)return;e(t.toString().slice(0,-1))}static getEditTarget(){return C.editTarget}static setEditTarget(t){C.editTarget=t}static clearEditTarget(){C.editTarget=null,C.getInstance().getNodes().forEach((t=>{t.setIsEditing(!1)}))}addNode(t){this.nodes.push(t)}removeNode(t){const e=this.nodes.indexOf(t);e>-1&&this.nodes.splice(e,1)}addEdge(t){this.edges.push(t)}removeEdge(t){const e=this.edges.indexOf(t);e>-1&&this.edges.splice(e,1)}getSelectedNodes(){return this.nodes.filter((t=>t.getIsSelected()))}getSelectedEdges(){return this.edges.filter((t=>t.getIsSelected()))}getSelectedPlugs(){const t=[];return this.nodes.forEach((e=>{t.push(...e.getSelectedPlugs())})),t}getSelectedParameters(){const t=[];return this.nodes.forEach((e=>{t.push(...e.getSelectedParameters())})),t}getRolledOverNodes(){return this.nodes.filter((t=>t.getIsRolledOver()))}getNodes(){return this.nodes}getEdges(){return this.edges}getInspector(){return this.inspector}getToolbox(){return this.toolbox}static createInstance(){return null===C.instance&&(C.instance=new C),C.instance}static getInstance(){return null===C.instance&&(console.warn("ApplicationModel instance is null"),C.instance=new C),C.instance}getDynamicTool(){return this.dynamicTool}setDynamicTool(t){this.dynamicTool=t}setDynamicSlot(t){this.dynamicTool=t}toString(){let t=`ApplicationModel:\n\t${this.nodes.length} nodes,\n\t${this.edges.length}\n`;return t+="NODES: [\n\t",this.nodes.forEach((e=>{t+=`\t${e.toString()},\n`})),t+="]\nEDGES: [\n\t",this.edges.forEach((e=>{t+=`\t${e.toString()},\n`})),t+="",t}}C.instance=null,C.editTarget=null;class x{static isNonPrintingCharacter(t){return 12!==t&&(13!==t&&(32!==t&&(t<=47||t>=91&&t<=93||t>=112&&t<=123)))}static handleKeyPress(t,e){const s=C.getEditTarget();if(console.log("editTarget",s),s){if(13===t&&C.clearEditTarget(),13!==t&&8!==t||C.backspaceEditTarget(),this.isNonPrintingCharacter(t))return;C.addCharacterToEditTarget(e)}}}class B{static checkForInspectorInfoRowRollover(t,e,s){const i=s.getInspector().getTable().getInfoRows();for(let s=0;s<i.length;s+=1){const n=i[s];if(console.log(`infoRow: ${n}`),n.checkBoundary(t,e,!0))return n}return null}static checkForRollover(t,e,s){if(this.checkForPlugRollover(t,e,s))return;if(this.checkForParamRollover(t,e,s))return;if(this.checkForToolsRollover(t,e,s))return;if(this.checkForNodeRollover(t,e,s))return;this.checkForEdgeRollover(t,e,s)||(s.getToolbox().checkBoundary(t,e)&&s.getToolbox().setIsRolledOver(),s.getInspector().checkBoundary(t,e)&&s.getInspector().setIsRolledOver())}static checkForPlugRollover(t,e,s){let i=null;const n=s.getNodes();for(let s=0;s<n.length;s+=1){const o=n[s].getPlugs();for(let s=0;s<o.length;s+=1){const n=o[s];n.checkBoundary(t,e)?(n.setIsRolledOver(),i=n):n.setIsRolledOver(!1)}}return i}static checkForParamRollover(t,e,s){let i=null;const n=s.getSelectedNodes();for(let s=0;s<n.length;s+=1){const o=n[s].getInputParameterList();for(let s=0;s<o.length;s+=1){const n=o[s];n.checkBoundary(t,e)?(n.setIsRolledOver(),i=n):n.setIsRolledOver(!1)}}for(let s=0;s<n.length;s+=1){const o=n[s].getOutputParameterList();for(let s=0;s<o.length;s+=1){const n=o[s];n.checkBoundary(t,e)?(n.setIsRolledOver(),i=n):n.setIsRolledOver(!1)}}return i}static checkForNodeRollover(t,e,s){let i=null;const n=s.getNodes();for(let s=0;s<n.length;s+=1){const o=n[s];o.checkBoundary(t,e)?(i=o,o.setIsRolledOver()):o.setIsRolledOver(!1)}return i}static checkForToolsRollover(t,e,s){let i=null;const n=s.getToolbox().getToolList();for(let s=0;s<n.length;s+=1){const o=n[s];o.checkBoundary(t,e)?(i=o,o.setIsRolledOver()):o.setIsRolledOver(!1)}return i}static checkForEdgeRollover(t,e,s){const i=s.getEdges();for(let s=0;s<i.length;s+=1){const n=i[s];n.checkBoundary(t,e)?n.setIsRolledOver():n.setIsRolledOver(!1)}return null}}class L{static checkElementsForClick(t,e,s){const i=s.getNodes();let n=!1;if(s){if(n=this.checkForClickOnParam(t,e,s),n)return;i.forEach((i=>{this.checkForSelectPlug(t,e,i),this.checkForSelectNode(t,e,s)}))}}static checkForSelectParam(t,e,s){let i=null;return s.checkBoundary(t,e)&&(s.setIsSelected(),i=s),i}static checkForSelectPlug(t,e,s){s.getPlugs().forEach((s=>{s.checkBoundary(t,e)&&s.setIsSelected()}))}static checkForClickOnParam(t,e,s){let i=!1;const n=[],o=s.getSelectedNodes();if(o&&o.length>0){const s=o[0].getInputParameterList(),r=o[0].getOutputParameterList();n.push(...s),n.push(...r);for(let s=0;s<n.length;s+=1){const o=n[s];void 0!==o&&(i=null!==this.checkForSelectParam(t,e,o))}}return i}static checkForSelectNode(t,e,s){const i=s.getNodes(),n=new r(t,e);for(let t=0;t<i.length;t+=1)if(null!==i[t]&&void 0!==i[t]){const e=i[t];!1===e.areParamsSelected()&&e.setIsSelected(!1),e.checkBoundary(n.x,n.y)&&e.clickAction()}}}class F{static checkForEdgeDragTargets(t){const e=t.getEdges();if(e.length>0)for(let t=0;t<e.length;t+=1){const s=e[t];if(void 0!==s&&(null!==s&&(null==s?void 0:s.getIsRolledOver())))return s}return null}static checkForPlugDragTargets(t){const e=t.getNodes().flatMap((t=>t.getPlugs()));if(e.length>0)for(let t=0;t<e.length;t+=1){const s=e[t];if(void 0!==s&&(null!==s&&s.getIsRolledOver()))return s}return null}static checkForNodeDragTargets(t){const e=t.getNodes();if(e.length>0)for(let t=0;t<e.length;t+=1){const s=e[t];if(void 0!==s&&(null!==s&&(null==s?void 0:s.getIsRolledOver())))return s}return null}static checkForToolsDragTargets(t){const e=t.getToolbox();if(e&&e.getIsRolledOver()){const t=e.getToolList();for(let e=0;e<t.length;e+=1){const s=t[e];if(s.getIsRolledOver())return s}}return null}static clearDragTargets(t){t.getNodes().forEach((t=>{t.setIsDragging(!1),t.getPlugs().forEach((t=>t.setIsDragging(!1)))})),t.getEdges().forEach((t=>t.setIsDragging(!1))),t.getToolbox().getToolList().forEach((t=>t.setIsDragging(!1)))}static getDragTarget(t){const e=F.checkForToolsDragTargets(t);if(e)return e.setIsDragging(!0),e;const s=F.checkForPlugDragTargets(t);if(s)return s.setIsDragging(!0),s;const i=F.checkForEdgeDragTargets(t);if(i)return i.setIsDragging(!0),i;const n=F.checkForNodeDragTargets(t);return n&&console.log("dragging node",n),n?(n.setIsDragging(!0),n):null}}class A{static mouseMoved(t,e,s){B.checkForRollover(t,e,s)}static mouseDragged(t,e,s){F.getDragTarget(s),C.getInstance().getDraggingNodes().forEach((s=>{s.dragToPosition(new r(t-20,e-20))}))}static mouseClicked(t,e,s){C.clearEditTarget(),L.checkElementsForClick(t,e,s)}static doubleClicked(t,e,s){console.log("mouse double clicked");const i=B.checkForNodeRollover(t,e,s);i&&i.doubleClickAction(),console.log("about to call checkforInspectorInfoRowRollover");const n=B.checkForInspectorInfoRowRollover(t,e,s);console.log(`parameter: ${n}`),n&&(console.log("parameter double clicked"),n instanceof D&&n.doubleClickAction(null),n instanceof N&&n.doubleClickAction(null))}static mousePressed(t,e,s){}static mouseReleased(t,e,s){if(null!==s.getDynamicTool()){const t=O.createNewObjectFromDynamicTool(s.getDynamicTool());s.getNodes().push(t),s.setDynamicTool(null)}s.setDynamicTool(null),F.clearDragTargets(s)}}class M{constructor(t){M.p=t}static createInstance(t){return M.instance=new M(t),M.instance}static getInstance(){if(null===M.instance)throw new Error("P5Reference instance is null");return M.instance}}M.instance=null,M.p=null;class H extends p{constructor(t,e,s,i=null,n=null){super(t,e,s,i,n,"DynamicTool")}}class _{static resizeCanvas(t,e,s){this.repositionElementOnResize(null==t?void 0:t.getToolbox(),e,s),this.repositionElementOnResize(null==t?void 0:t.getInspector(),e,s)}static dragDynamicTool(t,e,s=null){let i=t.getDynamicTool();null===i&&(i=new H(null==s?void 0:s.getName(),null==s?void 0:s.getIcon(),null==s?void 0:s.getObjectType(),null==s?void 0:s.position,null==s?void 0:s.dimensions),t.setDynamicTool(i)),i.dragToPosition(e)}static repositionElementOnResize(t,e,s){w.resizeCanvas(e,s),w.positionPanel(t)}}class ${constructor(t){$.p=t}static plotConnection(t,s){let i=t.dimensions;t instanceof f&&(i=new e(0,0));let n=s.dimensions;s instanceof f&&(n=new e(0,0));const o=t.position.x+i.width/2,l=t.position.y+i.height/2,c=s.position.x+n.width/2,a=s.position.y+n.height/2,g=o+(c-o)/2,u=g,h=a,d=new r(g,l),p=new r(u,h);return[new r(o,l),d,p,new r(c,a)]}static renderLines(t,e="rgb(200,0,0)"){const s=$.p;s.push(),s.noFill(),s.strokeWeight(3),s.stroke(e);for(let e=1;e<t.length;e+=1){const i=t[e-1],n=t[e];s.line(i.x,i.y,n.x,n.y)}s.pop()}static render(t){const e=t.getSourcePlug(),s=t.getTargetPlug();let i=[];if(null===e||null===s){const e=t.getSourceNode(),s=t.getTargetNode();i=this.plotConnection(e,s)}else{const e=t.getSourcePlug(),s=t.getTargetPlug();i=this.plotConnection(e,s)}this.renderLines(i)}}class W{constructor(t){W.p=t}static render(){const t=W.p;t.push(),t.noFill(),t.strokeWeight(1),t.stroke("rgb(255,255,255,0.5)");for(let e=1;e<t.width/100;e+=1)t.line(100*e,0,100*e,t.height);for(let e=1;e<t.height/100;e+=1)t.line(0,100*e,t.width,100*e);t.pop()}static getP(){return W.p}}class V{constructor(t){V.p=t}static renderInfoRow(t){const e=this.p,s=t.getColumns();if(null===e)throw new Error("p is null in RenderParameter");e.push(),e.translate(t.position.x,t.position.y),e.noFill(),t.getIsRolledOver()?(e.stroke("rgba(255,255,0,1)"),e.fill("rgba(255,255,0,0.2)")):e.stroke("rgba(0,255,255,0.7)"),e.strokeWeight(1),e.rect(0,0,t.dimensions.width,t.dimensions.height),e.fill(0),e.noStroke(),e.text(s[0].getContent(),10,20),e.text(s[1].getContent(),u.PARAM_NAME_COLUMN_WIDTH,20),e.pop()}static renderTable(t){var e;const s=V.getP(),i=t.getPosition(),n=t.getTable(),o=null==n?void 0:n.getNumRows();if(i){s.push(),s.translate(i.x,i.y);for(let s=0;s<o;s++){const i=null===(e=t.getTable())||void 0===e?void 0:e.getRow(s);i instanceof g&&V.renderInfoRow(i),i instanceof c&&V.renderHeadingRow(i)}s.pop()}}static renderHeadingRow(t){const e=this.p;if(null===e)throw new Error("p is null in RenderHeadingRow");e.push(),e.translate(t.position.x,t.position.y),e.noFill(),e.fill("rgba(200,255,200,1)"),e.rect(0,0,t.dimensions.width,t.dimensions.height),e.fill(0),e.text(t.getContent(),10,20),e.pop()}static render(t){t&&(V.renderBackground(t),V.renderInspectorBorder(t),V.renderTitleBar(t),V.renderTable(t))}static renderTitle(t){const e=V.getP(),s=t.getPosition();s&&(e.push(),e.fill(255),e.noStroke(),e.text("Object Inspector",s.x+10,s.y+20),e.push())}static renderTitleBar(t){const e=V.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(32,32,64,0.8)"),e.noStroke(),e.rect(s.x,s.y,i.width,30),e.pop(),V.renderTitle(t))}static renderBackground(t){const e=V.getP();if(t){const s=t.getPosition(),i=t.getDimensions();if(!s||!i)return;e.push(),e.fill("rgba(255,255,255,0.9)"),e.noStroke(),e.rect(s.x,s.y+30,i.width,i.height-30),e.pop()}else console.warn("InspectorModel is null")}static renderInspectorBorder(t){const e=V.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.noFill(),e.stroke("rgba(32,32,64,0.8)"),e.strokeWeight(3),e.rect(s.x,s.y,i.width,i.height),e.pop())}static getP(){return V.p}}class z{constructor(t){this.isSelected=!1,z.p=t}static renderPlug(t,e,s){if(null===t)return;const i=t.getPosition();if(null===i)return;const n=t.getIsSelected(),o=i.x,r=i.y;let l="rgba(200,200,200,0.7)",c="rgba(255,255,200,0.7)";t.checkBoundary(e.mouseX,e.mouseY)&&(l="rgba(255,255,72,1)",c="rgba(0,0,0,0.8)"),n&&(l="rgba(255,0,72,1)",c="rgba(255,0,72,1)"),t.getIsHighlit()&&(l="rgba(0,0,255,1)",c="rgba(0,255,255,1)"),e.push(),e.stroke(l),e.strokeWeight(2),e.fill(c),(n||s)&&e.circle(o,r,8),e.pop()}static showNodes(t,e,s){t.getPlugs().forEach((t=>{this.renderPlug(t,e,s)}))}static render(t,e){const s=10;t.getBoundary();const i=t.dimensions.width,n=t.dimensions.height,o=t.position.x,r=t.position.y,l=t.getLabel();let c="rgba(228,200,200,1)";t.getIsSelected()&&(c="rgba(255,255,200,1)"),e.push(),e.translate(o,r),e.noStroke(),e.fill("rgba(0,0,0,0.5)");let a="rgb(128,128,128)",g=1;t.getIsSelected()&&(a="rgb(255,200,0)",g=3),e.rect(0,5,i,n,0,s,s,s),e.fill(c),e.stroke(a),e.strokeWeight(g),e.rect(3,0,i,n,0,s,s,s),t.getIsEditing()?e.fill("rgba(200,0,0,1)"):e.fill(0),e.noStroke(),e.textAlign(e.CENTER,e.CENTER),e.text(l,6,3,i-6,n-6),t.getIsEditing()&&(e.noFill(),e.stroke("rgba(0,0,200,1)"),e.rect(10,10,i-10,n-20)),e.pop();const u=t.getIsRolledOver();this.showNodes(t,e,u),z.drawRolloverGuide(t.getBoundary(),e)}static drawRolloverGuide(t,e){e.push(),e.noFill(),e.stroke("rgb(0,255,255)"),e.strokeWeight(1),null!==t?(e.translate(t.getLeft(),t.getTop()),e.rect(0,0,t.getRight()-t.getLeft(),t.getBottom()-t.getTop()),e.pop()):console.warn("boundary is null in RenderNode.drawRolloverGuide")}}class G{constructor(t){G.p=t}static getP(){return G.p}static drawRolloverGuide(t,e){e.push(),e.noFill(),e.stroke("rgb(0,255,255)"),e.strokeWeight(1),null!==t?(e.translate(t.getLeft(),t.getTop()),e.rect(0,0,t.getRight()-t.getLeft(),t.getBottom()-t.getTop()),e.pop()):console.warn("boundary is null in RenderNode.drawRolloverGuide")}static render(t){const e=G.getP(),s=null==t?void 0:t.getBoundary();e.push();const i=null==t?void 0:t.getPosition(),n=null==t?void 0:t.getPosition();null!==i&&null!==n&&void 0!==i&&void 0!==n?("DynamicTool"===(null==t?void 0:t.type)?e.fill("rgba(255,255,0,1)"):"Tool"===(null==t?void 0:t.type)?e.fill("rgba(100,100,255,1)"):e.fill("rgba(128,0,255,1)"),e.stroke(72),e.strokeWeight(2),e.translate(s.getLeft(),s.getTop()),e.rect(0,0,s.getRight()-s.getLeft(),s.getBottom()-s.getTop()),e.noStroke(),e.fill(255),e.text(t.getName(),5,5,s.getRight()-s.getLeft(),s.getBottom()-s.getTop()),e.pop(),null!==s?this.drawRolloverGuide(s,e):console.warn("boundary is null in RenderTool.render")):console.warn("tool position data is null")}}class U{constructor(t){U.p=t}static getP(){return U.p}static renderTitle(t){const e=U.getP(),s=t.getPosition();s&&(e.push(),e.fill(255),e.noStroke(),e.text("TOOLBOX",s.x+10,s.y+20),e.push())}static renderTitleBar(t){const e=U.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(32,32,64,0.8)"),e.noStroke(),e.rect(s.x,s.y,i.width,30),e.fill(255),e.text("TOOLBOX",s.x+10,s.y+20),e.pop(),U.renderTitle(t))}static renderTools(t){t.getToolList().forEach((t=>{G.render(t)}))}static render(t){t?(U.renderBackground(t),U.renderTBBorder(t),U.renderTitleBar(t),U.renderTools(t)):console.warn("RenderToolbox.render: tbm is null")}static renderBackground(t){const e=U.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.push(),e.fill("rgba(255,255,255,0.85)"),e.noStroke(),e.rect(s.x,s.y+30,i.width,i.height-30),e.pop())}static renderTBBorder(t){const e=U.getP(),s=t.getPosition(),i=t.getDimensions();s&&i&&(e.noFill(),e.stroke("rgba(32,32,64,0.8)"),e.strokeWeight(3),e.rect(s.x,s.y,i.width,i.height))}}class Y{constructor(t){Y.p=t}static renderNodes(t,e){const s=null==e?void 0:e.getNodes();null==s||s.forEach((t=>{z.render(t,M.p)}))}static drawLeadLine(t,e,s,i){const n=[s,i];$.renderLines(n,"rgb(0,128,255)")}static renderElements(t){const e=M.p,s=null==t?void 0:t.getToolbox(),i=null==t?void 0:t.getInspector(),n=null==t?void 0:t.getDynamicTool();U.render(s),V.render(i),this.renderTools(e,t),this.renderEdges(t),this.renderNodes(e,t),null!==n&&G.render(n),W.render();const o=t.getSelectedPlugs();1===o.length&&Y.drawLeadLine(e,t,o[0].getPosition(),new r(e.mouseX,e.mouseY))}static renderEdges(t){const e=t.getEdges();null==e||e.forEach((t=>{$.render(t)}))}static renderTools(t,e){const s=e.getToolbox();null==s||s.getToolList().forEach((s=>{s.getIsDragging()&&_.dragDynamicTool(e,new r(t.mouseX-40,t.mouseY-20),s)}))}}Y.p=null;let X=null;let j,q=null,J=null;const K=(t=>{const e=Object.keys(t);return s=>{e.forEach((e=>{const i=t[e];i&&(s[e]=i.bind(void 0,s))}))}})({preload:t=>{X=C.createInstance(),t.loadFont("./font/Regular.otf"),M.createInstance(t)},setup:t=>{t.createCanvas(t.windowWidth,t.windowHeight),t.frameRate(30),t.background(248),(t=>{new z(t),new $(t),new W(t),new G(t),new U(t),new V(t),new Y(t)})(t)},draw:t=>{j=t,q===j.windowWidth&&J===j.windowHeight||(j.resizeCanvas(j.windowWidth,j.windowHeight),w.resizeCanvas(j.windowWidth,j.windowHeight),_.resizeCanvas(X,j.windowWidth,j.windowHeight),q=j.windowWidth,J=j.windowHeight),j.background("rgb(180,180,200)"),O.advanceState(),Y.renderElements(X)},mouseClicked:t=>{A.mouseClicked(t.mouseX,t.mouseY,X)},doubleClicked:t=>{A.doubleClicked(t.mouseX,t.mouseY,X)},mouseDragged:t=>{A.mouseDragged(t.mouseX,t.mouseY,X)},mousePressed:t=>{A.mousePressed(t.mouseX,t.mouseY,X)},mouseReleased:t=>{A.mouseReleased(t.mouseX,t.mouseY,X)},keyPressed:t=>{x.handleKeyPress(t.keyCode,t.key)},mouseMoved:t=>{A.mouseMoved(t.mouseX,t.mouseY,X)}});new t(K)}(p5);